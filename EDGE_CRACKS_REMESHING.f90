	SUBROUTINE EDGE_CRACKS_REMESHING
	USE ISOPARAMETRIC_MESH
	USE MATERIALS
	USE CRACKS_DUAL_BEM
	USE SUB_REGIONS_INTERFACES
	USE ANALYSIS
	USE REMESHING
	USE PROPAGATION
!
	IMPLICIT NONE 
!
	INTEGER::I,J,K,II,JJ,KK,NEN,CONT1,CONT2,ELEM1,ELEM2,ELEM3,ELEM,CP1,CP2,CP3,CP4,CP5,CP6,CP7,CP8,NODE1,NODE2,NODE3,NODE4,NODE5,NODE6,NODE7,NODE8,DELEM,DELEM_AUX,PREVIOUS_CRACKED_EDGES[ALLOCATABLE](:,:),PREVIOUS_NODES_CONNECTIVITY[ALLOCATABLE](:,:),PREVIOUS_COLLOCPOINTS_CONNECTIVITY[ALLOCATABLE](:,:)
	INTEGER::ELEM_TYPE_AUX[ALLOCATABLE](:),ORDER_ELEM_AUX[ALLOCATABLE](:),POL_FAMILY_AUX[ALLOCATABLE](:),NODES_CONNECTIVITY_AUX[ALLOCATABLE](:,:),COLLOCPOINTS_CONNECTIVITY_AUX[ALLOCATABLE](:,:),ND_AUX[ALLOCATABLE](:),CRACKED_EDGES_AUX[ALLOCATABLE](:,:),B_CONDITIONS_AUX[ALLOCATABLE](:),CRACK_TIP_AUX[ALLOCATABLE](:),NEW_ELEMENTS_AUX[ALLOCATABLE](:,:),EDGE_DISCONTINUITY_AUX[ALLOCATABLE](:,:)
	INTEGER::PREVIOUS_NEW_ELEMENTS[ALLOCATABLE](:,:) 
!	
    REAL*8::VALUES[ALLOCATABLE](:,:),COEFFICIENTS[ALLOCATABLE](:,:),PHI[ALLOCATABLE](:),DPHI[ALLOCATABLE](:,:),D2PHI[ALLOCATABLE](:,:,:),X1,X2,X3
    REAL*8::COORD_COLLOCPOINTS_AUX[ALLOCATABLE](:,:),COORD_NODES_AUX[ALLOCATABLE](:,:),COORD_INTERCEPTPOINTS_AUX[ALLOCATABLE](:,:,:),COORD_EXTRAINTERCEPTPOINTS_AUX[ALLOCATABLE](:,:),COORD_BOUNDARYCRACKTIP_AUX[ALLOCATABLE](:,:),COORD_BOUNDARYCRACKTIPSTOP_AUX[ALLOCATABLE](:,:,:),QSI_AUX[ALLOCATABLE](:,:,:),HG_AUX[ALLOCATABLE](:,:),UT_AUX[ALLOCATABLE](:)
!  
    CHARACTER*30::DISCONTINUOUS_COLLOCPOINTS_AUX[ALLOCATABLE](:),DUAL_BEM_AUX[ALLOCATABLE](:),EQ_TYPE_AUX[ALLOCATABLE](:),CRACKED_ELEM_AUX[ALLOCATABLE](:),CHANGEABLE_ELEM_AUX[ALLOCATABLE](:),CHANGEABLE_COLLOCPOINTS_AUX[ALLOCATABLE](:),PREVIOUS_CRACKED_ELEM_AUX[ALLOCATABLE](:)   	    
    CHARACTER*30::PREVIOUS_CRACKED_ELEM[ALLOCATABLE](:)
!    
    LOGICAL::INTERCEPTED_EDGE,NEW_ELEMENT,FIRST_STEP	
!
!------------------------------------------------------------------------------------------------------------------------------------------------------
!   NEW CLASSIFICATION OF THE BOUNDARY ELEMENTS   
!------------------------------------------------------------------------------------------------------------------------------------------------------
!
    ALLOCATE(PREVIOUS_CRACKED_ELEM(N_ELEM),PREVIOUS_CRACKED_EDGES((N_ELEM+N_ADDELEM),2))
    PREVIOUS_CRACKED_ELEM=CRACKED_ELEM
    PREVIOUS_CRACKED_EDGES=CRACKED_EDGES
!
    FIRST_STEP=.TRUE.
    DO I=1,N_ELEM
        IF(PREVIOUS_CRACKED_ELEM(I).NE."UNCRACKED")THEN
            FIRST_STEP=.FALSE.
        ENDIF
    ENDDO    
!      
    DO J=1,N_ELEM 
        NEW_ELEMENT=.FALSE.       
        DO K=1,N_ELEM
            IF(NEW_ELEMENTS(K,1).EQ.J)THEN
                NEW_ELEMENT=.TRUE.
            ENDIF
            IF(NEW_ELEMENTS(K,2).EQ.J)THEN
                NEW_ELEMENT=.TRUE.            
            ENDIF     
            IF(NEW_ELEMENTS(K,3).EQ.J)THEN
                NEW_ELEMENT=.TRUE.            
            ENDIF                     
        ENDDO    
        IF(DUAL_BEM(COLLOCPOINTS_CONNECTIVITY(J,1)).EQ."B".AND.NOT(NEW_ELEMENT))THEN
            CONT1=0
            DO K=1,ELEM_TYPE(J)    
                CALL INTERCEPTED_EDGES(J,K,INTERCEPTED_EDGE)
                IF(INTERCEPTED_EDGE)THEN
                    CONT1=CONT1+1
                    IF(CONT1.EQ.1)THEN
                        CRACKED_EDGES(J,1)=K
                        CRACKED_ELEM(J)="CRACKTIP"
                    ELSE
                        CRACKED_EDGES(J,2)=K
                        CRACKED_ELEM(J)="CRACKED"                      
                    ENDIF    
                ENDIF
            ENDDO
        ENDIF
    ENDDO     
!    
!------------------------------------------------------------------------------------------------------------------------------------------------------
!   DEFINING PROPRIETIES FOR THE NEW BOUNDARY CRACK INTERCEPTION 
!------------------------------------------------------------------------------------------------------------------------------------------------------
!
    CALL BOUNDARY_CRACK
!
!    CRACKED_EDGES(290,:)=0
!    CRACKED_ELEM(290)="UNCRACKED"
!    CRACKED_EDGES(293,:)=0
!    CRACKED_ELEM(293)="UNCRACKED"
!    CRACKED_EDGES(468,:)=0
!    CRACKED_ELEM(468)="UNCRACKED"
!    CRACKED_EDGES(471,:)=0
!    CRACKED_ELEM(471)="UNCRACKED"
!    
!    CRACKED_EDGES(4466,:)=0
!    CRACKED_ELEM(4466)="UNCRACKED"
!    CRACKED_EDGES(4471,:)=0
!    CRACKED_ELEM(4471)="UNCRACKED"      
!    CRACKED_EDGES(4476,:)=0
!    CRACKED_ELEM(4476)="UNCRACKED"
!    CRACKED_EDGES(4481,:)=0
!    CRACKED_ELEM(4481)="UNCRACKED"   
!    CRACKED_EDGES(4486,:)=0
!    CRACKED_ELEM(4486)="UNCRACKED"
!    CRACKED_EDGES(4495,:)=0
!    CRACKED_ELEM(4495)="UNCRACKED"
!    CRACKED_EDGES(4500,:)=0
!    CRACKED_ELEM(4500)="UNCRACKED"      
!    CRACKED_EDGES(4505,:)=0
!    CRACKED_ELEM(4505)="UNCRACKED"
!    CRACKED_EDGES(4510,:)=0
!    CRACKED_ELEM(4510)="UNCRACKED"   
!    CRACKED_EDGES(4515,:)=0
!    CRACKED_ELEM(4515)="UNCRACKED"                                                                                
!
!------------------------------------------------------------------------------------------------------------------------------------------------------
!   ALLOCATING ADDITIONAL MESH VARIABLES   
!------------------------------------------------------------------------------------------------------------------------------------------------------
!    
    N_ADDCOLLOCPOINTS=0
    N_ADDNODES=0
    N_ADDELEM=0
    DO J=1,N_ELEM
        IF(PREVIOUS_CRACKED_ELEM(J).EQ."UNCRACKED".AND.CRACKED_ELEM(J).EQ."CRACKED")THEN
            IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.3)THEN        
                N_ADDCOLLOCPOINTS=N_ADDCOLLOCPOINTS+4
                N_ADDNODES=N_ADDNODES+4 
                N_ADDELEM=N_ADDELEM+2
            ENDIF    
            IF(CRACKED_EDGES(J,1).EQ.2.AND.CRACKED_EDGES(J,2).EQ.4)THEN    
                N_ADDCOLLOCPOINTS=N_ADDCOLLOCPOINTS+4
                N_ADDNODES=N_ADDNODES+4 
                N_ADDELEM=N_ADDELEM+2
            ENDIF   
            IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.2)THEN    
                N_ADDCOLLOCPOINTS=N_ADDCOLLOCPOINTS+7
                N_ADDNODES=N_ADDNODES+7 
                N_ADDELEM=N_ADDELEM+3
            ENDIF  
            IF(CRACKED_EDGES(J,1).EQ.2.AND.CRACKED_EDGES(J,2).EQ.3)THEN    
                N_ADDCOLLOCPOINTS=N_ADDCOLLOCPOINTS+7
                N_ADDNODES=N_ADDNODES+7 
                N_ADDELEM=N_ADDELEM+3
            ENDIF  
            IF(CRACKED_EDGES(J,1).EQ.3.AND.CRACKED_EDGES(J,2).EQ.4)THEN    
                N_ADDCOLLOCPOINTS=N_ADDCOLLOCPOINTS+7
                N_ADDNODES=N_ADDNODES+7 
                N_ADDELEM=N_ADDELEM+3
            ENDIF   
            IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.4)THEN    
                N_ADDCOLLOCPOINTS=N_ADDCOLLOCPOINTS+7
                N_ADDNODES=N_ADDNODES+7 
                N_ADDELEM=N_ADDELEM+3
            ENDIF                                                                
        ELSE IF(PREVIOUS_CRACKED_ELEM(J).EQ."UNCRACKED".AND.CRACKED_ELEM(J).EQ."CRACKTIP")THEN
            IF(FIRST_STEP)THEN
                N_ADDCOLLOCPOINTS=N_ADDCOLLOCPOINTS+8
                N_ADDNODES=N_ADDNODES+8 
                N_ADDELEM=N_ADDELEM+3  
            ELSE          
                N_ADDCOLLOCPOINTS=N_ADDCOLLOCPOINTS+4
                N_ADDNODES=N_ADDNODES+4 
                N_ADDELEM=N_ADDELEM+2
            ENDIF
        ELSE IF(PREVIOUS_CRACKED_ELEM(J).EQ."CRACKTIP".AND.CRACKED_ELEM(J).EQ."CRACKED")THEN
            IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.2)THEN    
                N_ADDCOLLOCPOINTS=N_ADDCOLLOCPOINTS+3
                N_ADDNODES=N_ADDNODES+3 
                N_ADDELEM=N_ADDELEM+1
            ENDIF  
            IF(CRACKED_EDGES(J,1).EQ.2.AND.CRACKED_EDGES(J,2).EQ.3)THEN    
                N_ADDCOLLOCPOINTS=N_ADDCOLLOCPOINTS+3
                N_ADDNODES=N_ADDNODES+3 
                N_ADDELEM=N_ADDELEM+1
            ENDIF  
            IF(CRACKED_EDGES(J,1).EQ.3.AND.CRACKED_EDGES(J,2).EQ.4)THEN    
                N_ADDCOLLOCPOINTS=N_ADDCOLLOCPOINTS+3
                N_ADDNODES=N_ADDNODES+3 
                N_ADDELEM=N_ADDELEM+1
            ENDIF   
            IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.4)THEN    
                N_ADDCOLLOCPOINTS=N_ADDCOLLOCPOINTS+3
                N_ADDNODES=N_ADDNODES+3 
                N_ADDELEM=N_ADDELEM+1
            ENDIF                                  
        ENDIF   
    ENDDO
!    
    ALLOCATE(COORD_NODES_AUX(N_NODES,3),COORD_COLLOCPOINTS_AUX(N_COLLOCPOINTS,3),DISCONTINUOUS_COLLOCPOINTS_AUX(N_COLLOCPOINTS),CHANGEABLE_COLLOCPOINTS_AUX(N_COLLOCPOINTS),QSI_AUX(N_ELEM,9,2),ELEM_TYPE_AUX(N_ELEM),ORDER_ELEM_AUX(N_ELEM),POL_FAMILY_AUX(N_ELEM),NODES_CONNECTIVITY_AUX(N_ELEM,4),COLLOCPOINTS_CONNECTIVITY_AUX(N_ELEM,4),ND_AUX(N_ELEM),EDGE_DISCONTINUITY_AUX(N_ELEM,4),CRACKED_EDGES_AUX(N_ELEM,2),NEW_ELEMENTS_AUX(N_ELEM,3),CRACKED_ELEM_AUX(N_ELEM),PREVIOUS_CRACKED_ELEM_AUX(N_ELEM),CHANGEABLE_ELEM_AUX(N_ELEM),COORD_INTERCEPTPOINTS_AUX(N_ELEM,4,3),COORD_EXTRAINTERCEPTPOINTS_AUX(N_ELEM,3),COORD_BOUNDARYCRACKTIP_AUX(N_ELEM,3),COORD_BOUNDARYCRACKTIPSTOP_AUX(N_ELEM,2,3),DUAL_BEM_AUX(N_COLLOCPOINTS),EQ_TYPE_AUX(N_COLLOCPOINTS),B_CONDITIONS_AUX(3*N_COLLOCPOINTS),CRACK_TIP_AUX(N_COLLOCPOINTS))   
!
    COORD_NODES_AUX=COORD_NODES
    COORD_COLLOCPOINTS_AUX=COORD_COLLOCPOINTS
    QSI_AUX=QSI
    DISCONTINUOUS_COLLOCPOINTS_AUX=DISCONTINUOUS_COLLOCPOINTS
    EDGE_DISCONTINUITY_AUX=EDGE_DISCONTINUITY
    CHANGEABLE_COLLOCPOINTS_AUX=CHANGEABLE_COLLOCPOINTS    
    ELEM_TYPE_AUX=ELEM_TYPE
    ORDER_ELEM_AUX=ORDER_ELEM
    POL_FAMILY_AUX=POL_FAMILY
    NODES_CONNECTIVITY_AUX=NODES_CONNECTIVITY
    COLLOCPOINTS_CONNECTIVITY_AUX=COLLOCPOINTS_CONNECTIVITY
    ND_AUX=ND
    CRACKED_EDGES_AUX=CRACKED_EDGES 
    NEW_ELEMENTS_AUX=NEW_ELEMENTS     
    CRACKED_ELEM_AUX=CRACKED_ELEM
    PREVIOUS_CRACKED_ELEM_AUX=PREVIOUS_CRACKED_ELEM
    CHANGEABLE_ELEM_AUX=CHANGEABLE_ELEM
    COORD_INTERCEPTPOINTS_AUX=COORD_INTERCEPTPOINTS
    COORD_EXTRAINTERCEPTPOINTS_AUX=COORD_EXTRAINTERCEPTPOINTS    
    COORD_BOUNDARYCRACKTIP_AUX=COORD_BOUNDARYCRACKTIP
    COORD_BOUNDARYCRACKTIPSTOP_AUX=COORD_BOUNDARYCRACKTIPSTOP
    DUAL_BEM_AUX=DUAL_BEM 
    EQ_TYPE_AUX=EQ_TYPE   
    B_CONDITIONS_AUX=B_CONDITIONS
    CRACK_TIP_AUX=CRACK_TIP
    DEALLOCATE(COORD_NODES,COORD_COLLOCPOINTS,DISCONTINUOUS_COLLOCPOINTS,CHANGEABLE_COLLOCPOINTS,QSI,ELEM_TYPE,ORDER_ELEM,POL_FAMILY,NODES_CONNECTIVITY,COLLOCPOINTS_CONNECTIVITY,ND,EDGE_DISCONTINUITY,CRACKED_EDGES,NEW_ELEMENTS,CRACKED_ELEM,PREVIOUS_CRACKED_ELEM,CHANGEABLE_ELEM,COORD_INTERCEPTPOINTS,COORD_EXTRAINTERCEPTPOINTS,COORD_BOUNDARYCRACKTIP,COORD_BOUNDARYCRACKTIPSTOP,DUAL_BEM,EQ_TYPE,B_CONDITIONS,CRACK_TIP) 
    ALLOCATE(COORD_NODES(N_NODES+N_ADDNODES,3),COORD_COLLOCPOINTS(N_COLLOCPOINTS+N_ADDCOLLOCPOINTS,3),DISCONTINUOUS_COLLOCPOINTS(N_COLLOCPOINTS+N_ADDCOLLOCPOINTS),CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+N_ADDCOLLOCPOINTS),QSI(N_ELEM+N_ADDELEM,9,2),ELEM_TYPE(N_ELEM+N_ADDELEM),ORDER_ELEM(N_ELEM+N_ADDELEM),POL_FAMILY(N_ELEM+N_ADDELEM),NODES_CONNECTIVITY(N_ELEM+N_ADDELEM,4),COLLOCPOINTS_CONNECTIVITY(N_ELEM+N_ADDELEM,4),ND(N_ELEM+N_ADDELEM),EDGE_DISCONTINUITY(N_ELEM+N_ADDELEM,4),CRACKED_EDGES(N_ELEM+N_ADDELEM,2),NEW_ELEMENTS(N_ELEM+N_ADDELEM,3),CRACKED_ELEM(N_ELEM+N_ADDELEM),PREVIOUS_CRACKED_ELEM(N_ELEM+N_ADDELEM),CHANGEABLE_ELEM(N_ELEM+N_ADDELEM),COORD_INTERCEPTPOINTS(N_ELEM+N_ADDELEM,4,3),COORD_EXTRAINTERCEPTPOINTS(N_ELEM+N_ADDELEM,3),COORD_BOUNDARYCRACKTIP(N_ELEM+N_ADDELEM,3),COORD_BOUNDARYCRACKTIPSTOP(N_ELEM+N_ADDELEM,2,3),DUAL_BEM(N_COLLOCPOINTS+N_ADDCOLLOCPOINTS),EQ_TYPE(N_COLLOCPOINTS+N_ADDCOLLOCPOINTS),B_CONDITIONS(3*(N_COLLOCPOINTS+N_ADDCOLLOCPOINTS)),CRACK_TIP(N_COLLOCPOINTS+N_ADDCOLLOCPOINTS)) 
    COORD_NODES=0.D0  
    COORD_COLLOCPOINTS=0.D0
    QSI=0.D0 
    DISCONTINUOUS_COLLOCPOINTS="DISCONTINUOUS"
    CHANGEABLE_COLLOCPOINTS="UNCHANGEABLE"    
    ELEM_TYPE=4 
    ORDER_ELEM=1
    POL_FAMILY=1
    NODES_CONNECTIVITY=0
    COLLOCPOINTS_CONNECTIVITY=0
    ND=0
    EDGE_DISCONTINUITY=0    
    CRACKED_EDGES=0     
    NEW_ELEMENTS=0     
    CRACKED_ELEM="UNCRACKED"
    PREVIOUS_CRACKED_ELEM="UNCRACKED"
    CHANGEABLE_ELEM="UNCHANGEABLE"    
    COORD_INTERCEPTPOINTS=0.D0   
    COORD_EXTRAINTERCEPTPOINTS=0.D0   
    COORD_BOUNDARYCRACKTIP=0.D0
    COORD_BOUNDARYCRACKTIPSTOP=0.D0   
    DUAL_BEM="B"
    EQ_TYPE="S"
    B_CONDITIONS=1
    CRACK_TIP=0
!        
    DO I=1,N_NODES
        DO J=1,3
            COORD_NODES(I,J)=COORD_NODES_AUX(I,J)
        ENDDO
    ENDDO
    DO I=1,N_COLLOCPOINTS
        DISCONTINUOUS_COLLOCPOINTS(I)=DISCONTINUOUS_COLLOCPOINTS_AUX(I)
        DUAL_BEM(I)=DUAL_BEM_AUX(I)
        EQ_TYPE(I)=EQ_TYPE_AUX(I)
        B_CONDITIONS(3*I-2)=B_CONDITIONS_AUX(3*I-2)
        B_CONDITIONS(3*I-1)=B_CONDITIONS_AUX(3*I-1)  
        B_CONDITIONS(3*I)=B_CONDITIONS_AUX(3*I)
        CRACK_TIP(I)=CRACK_TIP_AUX(I)              
        DO J=1,3
            COORD_COLLOCPOINTS(I,J)=COORD_COLLOCPOINTS_AUX(I,J) 
        ENDDO     
    ENDDO
!    
    DO I=1,N_ELEM
        ELEM_TYPE(I)=ELEM_TYPE_AUX(I)
        ORDER_ELEM(I)=ORDER_ELEM_AUX(I)
        POL_FAMILY(I)=POL_FAMILY_AUX(I)
        ND(I)=ND_AUX(I)
        EDGE_DISCONTINUITY(I,:)=EDGE_DISCONTINUITY_AUX(I,:)
        CRACKED_ELEM(I)=CRACKED_ELEM_AUX(I)
        PREVIOUS_CRACKED_ELEM(I)=PREVIOUS_CRACKED_ELEM_AUX(I)
        CRACKED_EDGES(I,1)=CRACKED_EDGES_AUX(I,1)
        CRACKED_EDGES(I,2)=CRACKED_EDGES_AUX(I,2)
        NEW_ELEMENTS(I,1)=NEW_ELEMENTS_AUX(I,1)        
        NEW_ELEMENTS(I,2)=NEW_ELEMENTS_AUX(I,2)        
        NEW_ELEMENTS(I,3)=NEW_ELEMENTS_AUX(I,3)
        COORD_EXTRAINTERCEPTPOINTS(I,1)=COORD_EXTRAINTERCEPTPOINTS_AUX(I,1)   
        COORD_EXTRAINTERCEPTPOINTS(I,2)=COORD_EXTRAINTERCEPTPOINTS_AUX(I,2)  
        COORD_EXTRAINTERCEPTPOINTS(I,3)=COORD_EXTRAINTERCEPTPOINTS_AUX(I,3)                                        
        COORD_BOUNDARYCRACKTIP(I,1)=COORD_BOUNDARYCRACKTIP_AUX(I,1)
        COORD_BOUNDARYCRACKTIP(I,2)=COORD_BOUNDARYCRACKTIP_AUX(I,2)
        COORD_BOUNDARYCRACKTIP(I,3)=COORD_BOUNDARYCRACKTIP_AUX(I,3)    
        COORD_BOUNDARYCRACKTIPSTOP(I,1,1)=COORD_BOUNDARYCRACKTIPSTOP_AUX(I,1,1)
        COORD_BOUNDARYCRACKTIPSTOP(I,1,2)=COORD_BOUNDARYCRACKTIPSTOP_AUX(I,1,2)
        COORD_BOUNDARYCRACKTIPSTOP(I,1,3)=COORD_BOUNDARYCRACKTIPSTOP_AUX(I,1,3)   
        COORD_BOUNDARYCRACKTIPSTOP(I,2,1)=COORD_BOUNDARYCRACKTIPSTOP_AUX(I,2,1)
        COORD_BOUNDARYCRACKTIPSTOP(I,2,2)=COORD_BOUNDARYCRACKTIPSTOP_AUX(I,2,2)
        COORD_BOUNDARYCRACKTIPSTOP(I,2,3)=COORD_BOUNDARYCRACKTIPSTOP_AUX(I,2,3)
        DO J=1,9
            QSI(I,J,1)=QSI_AUX(I,J,1)
            QSI(I,J,2)=QSI_AUX(I,J,2)
        ENDDO                             
        DO J=1,4
            NODES_CONNECTIVITY(I,J)=NODES_CONNECTIVITY_AUX(I,J)
            COLLOCPOINTS_CONNECTIVITY(I,J)=COLLOCPOINTS_CONNECTIVITY_AUX(I,J)
            COORD_INTERCEPTPOINTS(I,J,1)=COORD_INTERCEPTPOINTS_AUX(I,J,1)
            COORD_INTERCEPTPOINTS(I,J,2)=COORD_INTERCEPTPOINTS_AUX(I,J,2)
            COORD_INTERCEPTPOINTS(I,J,3)=COORD_INTERCEPTPOINTS_AUX(I,J,3)            
        ENDDO
    ENDDO
!
    DEALLOCATE(COORD_NODES_AUX,COORD_COLLOCPOINTS_AUX,QSI_AUX,DISCONTINUOUS_COLLOCPOINTS_AUX,CHANGEABLE_COLLOCPOINTS_AUX,ELEM_TYPE_AUX,ORDER_ELEM_AUX,POL_FAMILY_AUX,NODES_CONNECTIVITY_AUX,COLLOCPOINTS_CONNECTIVITY_AUX,ND_AUX,EDGE_DISCONTINUITY_AUX,CRACKED_EDGES_AUX,NEW_ELEMENTS_AUX,CRACKED_ELEM_AUX,PREVIOUS_CRACKED_ELEM_AUX,CHANGEABLE_ELEM_AUX,COORD_INTERCEPTPOINTS_AUX,COORD_EXTRAINTERCEPTPOINTS_AUX,COORD_BOUNDARYCRACKTIP_AUX,COORD_BOUNDARYCRACKTIPSTOP_AUX,DUAL_BEM_AUX,EQ_TYPE_AUX,B_CONDITIONS_AUX,CRACK_TIP_AUX) 
!
    ALLOCATE(PREVIOUS_NODES_CONNECTIVITY((N_ELEM+N_ADDELEM),4),PREVIOUS_COLLOCPOINTS_CONNECTIVITY((N_ELEM+N_ADDELEM),4),PREVIOUS_NEW_ELEMENTS((N_ELEM+N_ADDELEM),3))
    PREVIOUS_NODES_CONNECTIVITY=NODES_CONNECTIVITY
    PREVIOUS_COLLOCPOINTS_CONNECTIVITY=COLLOCPOINTS_CONNECTIVITY
    PREVIOUS_NEW_ELEMENTS=NEW_ELEMENTS           
!
!------------------------------------------------------------------------------------------------------------------------------------------------------
!   DEFINING THE ADDITIONAL NODES AND THE ADDITIONAL ELEMENTS CONNECTIVITY   
!------------------------------------------------------------------------------------------------------------------------------------------------------
!
    CONT1=0 
    CONT2=0
    DO J=1,N_ELEM
        IF(PREVIOUS_CRACKED_ELEM(J).EQ."UNCRACKED".AND.CRACKED_ELEM(J).EQ."CRACKED")THEN            
            SELECT CASE(ELEM_TYPE(J))
            CASE(4)
                IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.3)THEN
                    CONT1=CONT1+4
                    COORD_NODES(N_NODES+CONT1-3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(N_NODES+CONT1-2,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)      
                    COORD_NODES(N_NODES+CONT1-1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(N_NODES+CONT1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:) 
!                            
                    CONT2=CONT2+2                           
                    ELEM_TYPE(N_ELEM+CONT2-1)=4         
                    ELEM_TYPE(N_ELEM+CONT2)=4
!                   
                    ND(N_ELEM+CONT2-1)=ND(J)  
                    ND(N_ELEM+CONT2)=ND(J)
! 
                    NEW_ELEMENTS(J,1)=N_ELEM+CONT2-1
                    NEW_ELEMENTS(J,2)=N_ELEM+CONT2                                                                                                                      
!                    
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=NODES_CONNECTIVITY(J,1)   
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=NODES_CONNECTIVITY(J,4)                             
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=N_NODES+CONT1-3   
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_NODES+CONT1-2  
!                    
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=COLLOCPOINTS_CONNECTIVITY(J,1)   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=COLLOCPOINTS_CONNECTIVITY(J,4)                             
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=N_COLLOCPOINTS+CONT1-3   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_COLLOCPOINTS+CONT1-2
!
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=EDGE_DISCONTINUITY(J,1)
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=EDGE_DISCONTINUITY(J,4) 
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=0     
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=0                                                            
!                                      
                    QSI(N_ELEM+CONT2-1,1,1)=QSI(J,1,1)  
                    QSI(N_ELEM+CONT2-1,1,2)=QSI(J,1,2) 
                    QSI(N_ELEM+CONT2-1,4,1)=QSI(J,4,1)  
                    QSI(N_ELEM+CONT2-1,4,2)=QSI(J,4,2)
                    QSI(N_ELEM+CONT2-1,2,1)=0.6D0
                    QSI(N_ELEM+CONT2-1,2,2)=-0.6D0    
                    QSI(N_ELEM+CONT2-1,3,1)=0.6D0
                    QSI(N_ELEM+CONT2-1,3,2)=0.6D0                                   
!                     
                    NODES_CONNECTIVITY(N_ELEM+CONT2,2)=NODES_CONNECTIVITY(J,2)   
                    NODES_CONNECTIVITY(N_ELEM+CONT2,3)=NODES_CONNECTIVITY(J,3)                             
                    NODES_CONNECTIVITY(N_ELEM+CONT2,1)=N_NODES+CONT1-1   
                    NODES_CONNECTIVITY(N_ELEM+CONT2,4)=N_NODES+CONT1
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=COLLOCPOINTS_CONNECTIVITY(J,2)   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=COLLOCPOINTS_CONNECTIVITY(J,3)                             
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=N_COLLOCPOINTS+CONT1-1   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=N_COLLOCPOINTS+CONT1
!
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=EDGE_DISCONTINUITY(J,2)   
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=EDGE_DISCONTINUITY(J,3) 
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=0  
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=0                                     
!                                        
                    QSI(N_ELEM+CONT2,2,1)=QSI(J,2,1)  
                    QSI(N_ELEM+CONT2,2,2)=QSI(J,2,2) 
                    QSI(N_ELEM+CONT2,3,1)=QSI(J,3,1)  
                    QSI(N_ELEM+CONT2,3,2)=QSI(J,3,2)
                    QSI(N_ELEM+CONT2,1,1)=-0.6D0
                    QSI(N_ELEM+CONT2,1,2)=-0.6D0    
                    QSI(N_ELEM+CONT2,4,1)=-0.6D0
                    QSI(N_ELEM+CONT2,4,2)=0.6D0                                                 
                ENDIF 
                IF(CRACKED_EDGES(J,1).EQ.2.AND.CRACKED_EDGES(J,2).EQ.4)THEN
                    CONT1=CONT1+4
                    COORD_NODES(N_NODES+CONT1-3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(N_NODES+CONT1-2,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)      
                    COORD_NODES(N_NODES+CONT1-1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(N_NODES+CONT1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:) 
!                         
                    CONT2=CONT2+2        
                    ELEM_TYPE(N_ELEM+CONT2-1)=4          
                    ELEM_TYPE(N_ELEM+CONT2)=4
!
                    ND(N_ELEM+CONT2-1)=ND(J)  
                    ND(N_ELEM+CONT2)=ND(J)
! 
                    NEW_ELEMENTS(J,1)=N_ELEM+CONT2-1
                    NEW_ELEMENTS(J,2)=N_ELEM+CONT2                                                                
!
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=NODES_CONNECTIVITY(J,1)   
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=NODES_CONNECTIVITY(J,2)                             
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_NODES+CONT1-3   
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_NODES+CONT1-2  
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=COLLOCPOINTS_CONNECTIVITY(J,1)   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                             
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_COLLOCPOINTS+CONT1-3   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_COLLOCPOINTS+CONT1-2
!
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=EDGE_DISCONTINUITY(J,1)  
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=EDGE_DISCONTINUITY(J,2)    
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=0
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=0                 
!                                        
                    QSI(N_ELEM+CONT2-1,1,1)=QSI(J,1,1)  
                    QSI(N_ELEM+CONT2-1,1,2)=QSI(J,1,2) 
                    QSI(N_ELEM+CONT2-1,2,1)=QSI(J,2,1)  
                    QSI(N_ELEM+CONT2-1,2,2)=QSI(J,2,2)
                    QSI(N_ELEM+CONT2-1,3,1)=0.6D0
                    QSI(N_ELEM+CONT2-1,3,2)=0.6D0    
                    QSI(N_ELEM+CONT2-1,4,1)=-0.6D0
                    QSI(N_ELEM+CONT2-1,4,2)=0.6D0 
!                       
                    NODES_CONNECTIVITY(N_ELEM+CONT2,3)=NODES_CONNECTIVITY(J,3)   
                    NODES_CONNECTIVITY(N_ELEM+CONT2,4)=NODES_CONNECTIVITY(J,4)                             
                    NODES_CONNECTIVITY(N_ELEM+CONT2,1)=N_NODES+CONT1    
                    NODES_CONNECTIVITY(N_ELEM+CONT2,2)=N_NODES+CONT1-1 
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=COLLOCPOINTS_CONNECTIVITY(J,3)   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=COLLOCPOINTS_CONNECTIVITY(J,4)                             
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=N_COLLOCPOINTS+CONT1     
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=N_COLLOCPOINTS+CONT1-1
!
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=EDGE_DISCONTINUITY(J,3)  
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=EDGE_DISCONTINUITY(J,4)    
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=0
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=0                     
!                                        
                    QSI(N_ELEM+CONT2,3,1)=QSI(J,3,1)  
                    QSI(N_ELEM+CONT2,3,2)=QSI(J,3,2) 
                    QSI(N_ELEM+CONT2,4,1)=QSI(J,4,1)  
                    QSI(N_ELEM+CONT2,4,2)=QSI(J,4,2)
                    QSI(N_ELEM+CONT2,1,1)=-0.6D0
                    QSI(N_ELEM+CONT2,1,2)=-0.6D0    
                    QSI(N_ELEM+CONT2,2,1)=0.6D0
                    QSI(N_ELEM+CONT2,2,2)=-0.6D0                                                              
                ENDIF    
                IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.2)THEN
                    CONT1=CONT1+7
                    COORD_NODES(N_NODES+CONT1-6,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(N_NODES+CONT1-5,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:) 
                    COORD_NODES(N_NODES+CONT1-4,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)                          
                    COORD_NODES(N_NODES+CONT1-3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(N_NODES+CONT1-2,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)
                    COORD_NODES(N_NODES+CONT1-1,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)
                    COORD_NODES(N_NODES+CONT1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                     
!                         
                    CONT2=CONT2+3        
                    ELEM_TYPE(N_ELEM+CONT2-2)=3          
                    ELEM_TYPE(N_ELEM+CONT2-1)=4
                    ELEM_TYPE(N_ELEM+CONT2)=4                    
!
                    ND(N_ELEM+CONT2-2)=ND(J)
                    ND(N_ELEM+CONT2-1)=ND(J)  
                    ND(N_ELEM+CONT2)=ND(J)
! 
                    NEW_ELEMENTS(J,1)=N_ELEM+CONT2-2
                    NEW_ELEMENTS(J,2)=N_ELEM+CONT2-1
                    NEW_ELEMENTS(J,3)=N_ELEM+CONT2                                                                
!
                    NODES_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_NODES+CONT1-5   
                    NODES_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_NODES+CONT1-6                             
                    NODES_CONNECTIVITY(N_ELEM+CONT2-2,3)=NODES_CONNECTIVITY(J,2)    
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_COLLOCPOINTS+CONT1-5   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_COLLOCPOINTS+CONT1-6                             
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,3)=COLLOCPOINTS_CONNECTIVITY(J,2)
!                    
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-2,1)=0 
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-2,2)=0 
                    IF(EDGE_DISCONTINUITY(J,2).EQ.1)THEN
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=2
                    ELSE IF(EDGE_DISCONTINUITY(J,2).EQ.2)THEN  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=3
                    ELSE
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=0
                    ENDIF
!                                        
                    QSI(N_ELEM+CONT2-2,1,1)=0.8D0 
                    QSI(N_ELEM+CONT2-2,1,2)=0.1D0
                    QSI(N_ELEM+CONT2-2,2,1)=0.1D0
                    QSI(N_ELEM+CONT2-2,2,2)=0.8D0
                    QSI(N_ELEM+CONT2-2,3,1)=0.D0
                    QSI(N_ELEM+CONT2-2,3,2)=0.D0  
!                    
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=NODES_CONNECTIVITY(J,1)   
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=N_NODES+CONT1-3                            
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_NODES+CONT1-2    
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_NODES+CONT1-4 
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=COLLOCPOINTS_CONNECTIVITY(J,1)   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=N_COLLOCPOINTS+CONT1-3                              
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_COLLOCPOINTS+CONT1-2     
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_COLLOCPOINTS+CONT1-4
!
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=EDGE_DISCONTINUITY(J,1) 
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=0 
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=0      
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=0                  
!                                        
                    QSI(N_ELEM+CONT2-1,1,1)=QSI(J,1,1)  
                    QSI(N_ELEM+CONT2-1,1,2)=QSI(J,1,2) 
                    QSI(N_ELEM+CONT2-1,2,1)=0.6D0
                    QSI(N_ELEM+CONT2-1,2,2)=-0.6D0
                    QSI(N_ELEM+CONT2-1,3,1)=0.6D0
                    QSI(N_ELEM+CONT2-1,3,2)=0.6D0    
                    QSI(N_ELEM+CONT2-1,4,1)=-0.6D0
                    QSI(N_ELEM+CONT2-1,4,2)=0.6D0  
!                    
                    NODES_CONNECTIVITY(N_ELEM+CONT2,1)=N_NODES+CONT1-1  
                    NODES_CONNECTIVITY(N_ELEM+CONT2,2)=N_NODES+CONT1                            
                    NODES_CONNECTIVITY(N_ELEM+CONT2,3)=NODES_CONNECTIVITY(J,3)     
                    NODES_CONNECTIVITY(N_ELEM+CONT2,4)=NODES_CONNECTIVITY(J,4)   
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=N_COLLOCPOINTS+CONT1-1     
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=N_COLLOCPOINTS+CONT1                              
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=COLLOCPOINTS_CONNECTIVITY(J,3)      
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=COLLOCPOINTS_CONNECTIVITY(J,4)
!
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=0  
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=0 
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=EDGE_DISCONTINUITY(J,3)      
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=EDGE_DISCONTINUITY(J,4)                         
!                                        
                    QSI(N_ELEM+CONT2,1,1)=-0.6D0
                    QSI(N_ELEM+CONT2,1,2)=-0.6D0
                    QSI(N_ELEM+CONT2,2,1)=0.6D0
                    QSI(N_ELEM+CONT2,2,2)=-0.6D0
                    QSI(N_ELEM+CONT2,3,1)=QSI(J,3,1)  
                    QSI(N_ELEM+CONT2,3,2)=QSI(J,3,2) 
                    QSI(N_ELEM+CONT2,4,1)=QSI(J,4,1)  
                    QSI(N_ELEM+CONT2,4,2)=QSI(J,4,2)                                                                             
                ENDIF   
                IF(CRACKED_EDGES(J,1).EQ.2.AND.CRACKED_EDGES(J,2).EQ.3)THEN
                    CONT1=CONT1+7
                    COORD_NODES(N_NODES+CONT1-6,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(N_NODES+CONT1-5,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:) 
                    COORD_NODES(N_NODES+CONT1-4,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)                          
                    COORD_NODES(N_NODES+CONT1-3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(N_NODES+CONT1-2,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)
                    COORD_NODES(N_NODES+CONT1-1,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)
                    COORD_NODES(N_NODES+CONT1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                     
!                         
                    CONT2=CONT2+3        
                    ELEM_TYPE(N_ELEM+CONT2-2)=3          
                    ELEM_TYPE(N_ELEM+CONT2-1)=4
                    ELEM_TYPE(N_ELEM+CONT2)=4                    
!
                    ND(N_ELEM+CONT2-2)=ND(J)
                    ND(N_ELEM+CONT2-1)=ND(J)  
                    ND(N_ELEM+CONT2)=ND(J)
! 
                    NEW_ELEMENTS(J,1)=N_ELEM+CONT2-2
                    NEW_ELEMENTS(J,2)=N_ELEM+CONT2-1
                    NEW_ELEMENTS(J,3)=N_ELEM+CONT2                                                                
!
                    NODES_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_NODES+CONT1-5   
                    NODES_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_NODES+CONT1-6                           
                    NODES_CONNECTIVITY(N_ELEM+CONT2-2,3)=NODES_CONNECTIVITY(J,3)      
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_COLLOCPOINTS+CONT1-5   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_COLLOCPOINTS+CONT1-6                            
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,3)=COLLOCPOINTS_CONNECTIVITY(J,3) 
!                    
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-2,1)=0 
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-2,2)=0 
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=EDGE_DISCONTINUITY(J,3)                       
!                                        
                    QSI(N_ELEM+CONT2-2,1,1)=0.8D0 
                    QSI(N_ELEM+CONT2-2,1,2)=0.1D0
                    QSI(N_ELEM+CONT2-2,2,1)=0.1D0
                    QSI(N_ELEM+CONT2-2,2,2)=0.8D0
                    QSI(N_ELEM+CONT2-2,3,1)=0.D0
                    QSI(N_ELEM+CONT2-2,3,2)=0.D0  
!                    
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=N_NODES+CONT1-4    
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=NODES_CONNECTIVITY(J,2)                           
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_NODES+CONT1-3    
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_NODES+CONT1-2 
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=N_COLLOCPOINTS+CONT1-4   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                             
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_COLLOCPOINTS+CONT1-3     
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_COLLOCPOINTS+CONT1-2
!
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=0
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=EDGE_DISCONTINUITY(J,2)  
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=0      
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=0                      
!                                        
                    QSI(N_ELEM+CONT2-1,1,1)=-0.6D0
                    QSI(N_ELEM+CONT2-1,1,2)=-0.6D0 
                    QSI(N_ELEM+CONT2-1,2,1)=QSI(J,2,1)
                    QSI(N_ELEM+CONT2-1,2,2)=QSI(J,2,2)
                    QSI(N_ELEM+CONT2-1,3,1)=0.6D0
                    QSI(N_ELEM+CONT2-1,3,2)=0.6D0    
                    QSI(N_ELEM+CONT2-1,4,1)=-0.6D0
                    QSI(N_ELEM+CONT2-1,4,2)=0.6D0  
!                    
                    NODES_CONNECTIVITY(N_ELEM+CONT2,1)=NODES_CONNECTIVITY(J,1)  
                    NODES_CONNECTIVITY(N_ELEM+CONT2,2)=N_NODES+CONT1-1                            
                    NODES_CONNECTIVITY(N_ELEM+CONT2,3)=N_NODES+CONT1   
                    NODES_CONNECTIVITY(N_ELEM+CONT2,4)=NODES_CONNECTIVITY(J,4)   
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=COLLOCPOINTS_CONNECTIVITY(J,1)  
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=N_COLLOCPOINTS+CONT1-1                              
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=N_COLLOCPOINTS+CONT1  
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=COLLOCPOINTS_CONNECTIVITY(J,4) 
!
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=EDGE_DISCONTINUITY(J,1)
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=0  
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=0      
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=EDGE_DISCONTINUITY(J,4)                       
!                                        
                    QSI(N_ELEM+CONT2,1,1)=QSI(J,1,1) 
                    QSI(N_ELEM+CONT2,1,2)=QSI(J,1,2) 
                    QSI(N_ELEM+CONT2,2,1)=0.6D0
                    QSI(N_ELEM+CONT2,2,2)=-0.6D0
                    QSI(N_ELEM+CONT2,3,1)=0.6D0 
                    QSI(N_ELEM+CONT2,3,2)=0.6D0
                    QSI(N_ELEM+CONT2,4,1)=QSI(J,4,1)  
                    QSI(N_ELEM+CONT2,4,2)=QSI(J,4,2)                                                                             
                ENDIF
                IF(CRACKED_EDGES(J,1).EQ.3.AND.CRACKED_EDGES(J,2).EQ.4)THEN
                    CONT1=CONT1+7
                    COORD_NODES(N_NODES+CONT1-6,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(N_NODES+CONT1-5,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:) 
                    COORD_NODES(N_NODES+CONT1-4,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)                          
                    COORD_NODES(N_NODES+CONT1-3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(N_NODES+CONT1-2,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)
                    COORD_NODES(N_NODES+CONT1-1,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)
                    COORD_NODES(N_NODES+CONT1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                     
!                         
                    CONT2=CONT2+3        
                    ELEM_TYPE(N_ELEM+CONT2-2)=3          
                    ELEM_TYPE(N_ELEM+CONT2-1)=4
                    ELEM_TYPE(N_ELEM+CONT2)=4                    
!
                    ND(N_ELEM+CONT2-2)=ND(J)
                    ND(N_ELEM+CONT2-1)=ND(J)  
                    ND(N_ELEM+CONT2)=ND(J)
! 
                    NEW_ELEMENTS(J,1)=N_ELEM+CONT2-2
                    NEW_ELEMENTS(J,2)=N_ELEM+CONT2-1
                    NEW_ELEMENTS(J,3)=N_ELEM+CONT2                                                                
!
                    NODES_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_NODES+CONT1-5   
                    NODES_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_NODES+CONT1-6                           
                    NODES_CONNECTIVITY(N_ELEM+CONT2-2,3)=NODES_CONNECTIVITY(J,4)      
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_COLLOCPOINTS+CONT1-5   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_COLLOCPOINTS+CONT1-6                            
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,3)=COLLOCPOINTS_CONNECTIVITY(J,4)
!                    
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-2,1)=0 
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-2,2)=0
                    IF(EDGE_DISCONTINUITY(J,4).EQ.3)THEN 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=2
                    ELSE IF(EDGE_DISCONTINUITY(J,4).EQ.4)THEN      
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=3
                    ELSE
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=0
                    ENDIF         
!                                           
                    QSI(N_ELEM+CONT2-2,1,1)=0.8D0 
                    QSI(N_ELEM+CONT2-2,1,2)=0.1D0
                    QSI(N_ELEM+CONT2-2,2,1)=0.1D0
                    QSI(N_ELEM+CONT2-2,2,2)=0.8D0
                    QSI(N_ELEM+CONT2-2,3,1)=0.D0
                    QSI(N_ELEM+CONT2-2,3,2)=0.D0  
!                    
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=N_NODES+CONT1-2    
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=N_NODES+CONT1-4                           
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=NODES_CONNECTIVITY(J,3)    
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_NODES+CONT1-3 
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=N_COLLOCPOINTS+CONT1-2   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=N_COLLOCPOINTS+CONT1-4                             
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=COLLOCPOINTS_CONNECTIVITY(J,3)    
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_COLLOCPOINTS+CONT1-3
!
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=0
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=0  
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=EDGE_DISCONTINUITY(J,3)      
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=0                      
!                    
                    QSI(N_ELEM+CONT2-1,1,1)=-0.6D0
                    QSI(N_ELEM+CONT2-1,1,2)=-0.6D0 
                    QSI(N_ELEM+CONT2-1,2,1)=0.6D0
                    QSI(N_ELEM+CONT2-1,2,2)=-0.6D0
                    QSI(N_ELEM+CONT2-1,3,1)=QSI(J,3,1)
                    QSI(N_ELEM+CONT2-1,3,2)=QSI(J,3,2)  
                    QSI(N_ELEM+CONT2-1,4,1)=-0.6D0
                    QSI(N_ELEM+CONT2-1,4,2)=0.6D0  
!                    
                    NODES_CONNECTIVITY(N_ELEM+CONT2,1)=NODES_CONNECTIVITY(J,1)  
                    NODES_CONNECTIVITY(N_ELEM+CONT2,2)=NODES_CONNECTIVITY(J,2)                           
                    NODES_CONNECTIVITY(N_ELEM+CONT2,3)=N_NODES+CONT1-1   
                    NODES_CONNECTIVITY(N_ELEM+CONT2,4)=N_NODES+CONT1   
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=COLLOCPOINTS_CONNECTIVITY(J,1)  
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                              
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=N_COLLOCPOINTS+CONT1-1  
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=N_COLLOCPOINTS+CONT1
!
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=EDGE_DISCONTINUITY(J,1)
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=EDGE_DISCONTINUITY(J,2)  
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=0      
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=0                       
!                                        
                    QSI(N_ELEM+CONT2,1,1)=QSI(J,1,1) 
                    QSI(N_ELEM+CONT2,1,2)=QSI(J,1,2) 
                    QSI(N_ELEM+CONT2,2,1)=QSI(J,2,1) 
                    QSI(N_ELEM+CONT2,2,2)=QSI(J,2,2)
                    QSI(N_ELEM+CONT2,3,1)=0.6D0 
                    QSI(N_ELEM+CONT2,3,2)=0.6D0
                    QSI(N_ELEM+CONT2,4,1)=-0.6D0  
                    QSI(N_ELEM+CONT2,4,2)=0.6D0                                                                              
                ENDIF 
                IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.4)THEN
                    CONT1=CONT1+7
                    COORD_NODES(N_NODES+CONT1-6,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(N_NODES+CONT1-5,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:) 
                    COORD_NODES(N_NODES+CONT1-4,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)                          
                    COORD_NODES(N_NODES+CONT1-3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(N_NODES+CONT1-2,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)
                    COORD_NODES(N_NODES+CONT1-1,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)
                    COORD_NODES(N_NODES+CONT1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                     
!                         
                    CONT2=CONT2+3        
                    ELEM_TYPE(N_ELEM+CONT2-2)=3          
                    ELEM_TYPE(N_ELEM+CONT2-1)=4
                    ELEM_TYPE(N_ELEM+CONT2)=4                    
!
                    ND(N_ELEM+CONT2-2)=ND(J)
                    ND(N_ELEM+CONT2-1)=ND(J)  
                    ND(N_ELEM+CONT2)=ND(J)
! 
                    NEW_ELEMENTS(J,1)=N_ELEM+CONT2-2
                    NEW_ELEMENTS(J,2)=N_ELEM+CONT2-1
                    NEW_ELEMENTS(J,3)=N_ELEM+CONT2                                                                
!
                    NODES_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_NODES+CONT1-6   
                    NODES_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_NODES+CONT1-5                           
                    NODES_CONNECTIVITY(N_ELEM+CONT2-2,3)=NODES_CONNECTIVITY(J,1)      
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_COLLOCPOINTS+CONT1-6   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_COLLOCPOINTS+CONT1-5                            
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,3)=COLLOCPOINTS_CONNECTIVITY(J,1)  
!                    
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-2,1)=0 
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-2,2)=0
                    IF(EDGE_DISCONTINUITY(J,1).EQ.1)THEN 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=3
                    ELSE IF(EDGE_DISCONTINUITY(J,1).EQ.4)THEN 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=2
                    ELSE
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=0
                    ENDIF                                
!                                        
                    QSI(N_ELEM+CONT2-2,1,1)=0.8D0 
                    QSI(N_ELEM+CONT2-2,1,2)=0.1D0
                    QSI(N_ELEM+CONT2-2,2,1)=0.1D0
                    QSI(N_ELEM+CONT2-2,2,2)=0.8D0
                    QSI(N_ELEM+CONT2-2,3,1)=0.D0
                    QSI(N_ELEM+CONT2-2,3,2)=0.D0  
!                    
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=N_NODES+CONT1-3    
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=NODES_CONNECTIVITY(J,2)                     
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_NODES+CONT1-4    
                    NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_NODES+CONT1-2
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=N_COLLOCPOINTS+CONT1-3   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                            
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_COLLOCPOINTS+CONT1-4    
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_COLLOCPOINTS+CONT1-2 
!
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=0
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=EDGE_DISCONTINUITY(J,2)   
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=0     
                    EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=0                       
!                                        
                    QSI(N_ELEM+CONT2-1,1,1)=-0.6D0
                    QSI(N_ELEM+CONT2-1,1,2)=-0.6D0 
                    QSI(N_ELEM+CONT2-1,2,1)=QSI(J,2,1)
                    QSI(N_ELEM+CONT2-1,2,2)=QSI(J,2,2)
                    QSI(N_ELEM+CONT2-1,3,1)=0.6D0
                    QSI(N_ELEM+CONT2-1,3,2)=0.6D0    
                    QSI(N_ELEM+CONT2-1,4,1)=-0.6D0
                    QSI(N_ELEM+CONT2-1,4,2)=0.6D0
!                    
                    NODES_CONNECTIVITY(N_ELEM+CONT2,1)=N_NODES+CONT1  
                    NODES_CONNECTIVITY(N_ELEM+CONT2,2)=N_NODES+CONT1-1                           
                    NODES_CONNECTIVITY(N_ELEM+CONT2,3)=NODES_CONNECTIVITY(J,3)    
                    NODES_CONNECTIVITY(N_ELEM+CONT2,4)=NODES_CONNECTIVITY(J,4)    
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=N_COLLOCPOINTS+CONT1
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=N_COLLOCPOINTS+CONT1-1                              
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=COLLOCPOINTS_CONNECTIVITY(J,3)
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=COLLOCPOINTS_CONNECTIVITY(J,4)
!
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=0
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=0  
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=EDGE_DISCONTINUITY(J,3)      
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=EDGE_DISCONTINUITY(J,4)                          
!                                        
                    QSI(N_ELEM+CONT2,1,1)=-0.6D0 
                    QSI(N_ELEM+CONT2,1,2)=-0.6D0  
                    QSI(N_ELEM+CONT2,2,1)=0.6D0 
                    QSI(N_ELEM+CONT2,2,2)=-0.6D0 
                    QSI(N_ELEM+CONT2,3,1)=QSI(J,3,1)  
                    QSI(N_ELEM+CONT2,3,2)=QSI(J,3,2)
                    QSI(N_ELEM+CONT2,4,1)=QSI(J,4,1)    
                    QSI(N_ELEM+CONT2,4,2)=QSI(J,4,2)                                                                               
                ENDIF                                                                                          
            ENDSELECT                       
        ELSE IF(PREVIOUS_CRACKED_ELEM(J).EQ."UNCRACKED".AND.CRACKED_ELEM(J).EQ."CRACKTIP")THEN
            IF(FIRST_STEP)THEN
                CONT1=CONT1+8
                COORD_NODES(N_NODES+CONT1-7,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                COORD_NODES(N_NODES+CONT1-6,:)=COORD_BOUNDARYCRACKTIP(J,:)      
                COORD_NODES(N_NODES+CONT1-5,:)=COORD_BOUNDARYCRACKTIPSTOP(J,1,:)
                COORD_NODES(N_NODES+CONT1-4,:)=COORD_BOUNDARYCRACKTIPSTOP(J,2,:)    
                COORD_NODES(N_NODES+CONT1-3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                COORD_NODES(N_NODES+CONT1-2,:)=COORD_BOUNDARYCRACKTIP(J,:)      
                COORD_NODES(N_NODES+CONT1-1,:)=COORD_BOUNDARYCRACKTIPSTOP(J,1,:)
                COORD_NODES(N_NODES+CONT1,:)=COORD_BOUNDARYCRACKTIPSTOP(J,2,:)
    !
                CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-7)="CHANGEABLE"   
                CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-6)="CHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-5)="CHANGEABLE"   
                CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-4)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-3)="CHANGEABLE"   
                CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-2)="CHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-1)="CHANGEABLE"   
                CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1)="CHANGEABLE"                                          
                SELECT CASE(ELEM_TYPE(J))
                CASE(4)
                    IF(CRACKED_EDGES(J,1).EQ.1)THEN
                        CONT2=CONT2+3                           
                        ELEM_TYPE(N_ELEM+CONT2-2)=4         
                        ELEM_TYPE(N_ELEM+CONT2-1)=4
                        ELEM_TYPE(N_ELEM+CONT2)=4                            
    !                   
                        ND(N_ELEM+CONT2-2)=ND(J)  
                        ND(N_ELEM+CONT2-1)=ND(J)
                        ND(N_ELEM+CONT2)=ND(J)                    
    !                    
                        CHANGEABLE_ELEM(N_ELEM+CONT2-2)="CHANGEABLE" 
                        CHANGEABLE_ELEM(N_ELEM+CONT2-1)="CHANGEABLE" 
                        CHANGEABLE_ELEM(N_ELEM+CONT2)="CHANGEABLE"
    !
                        NEW_ELEMENTS(J,1)=N_ELEM+CONT2-2  
                        NEW_ELEMENTS(J,2)=N_ELEM+CONT2-1
                        NEW_ELEMENTS(J,3)=N_ELEM+CONT2                                                                                                                                                                                                                                               
    !                    
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_NODES+CONT1-7     
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,2)=NODES_CONNECTIVITY(J,2)                             
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,3)=N_NODES+CONT1-5   
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,4)=N_NODES+CONT1-6     
    !                    
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_COLLOCPOINTS+CONT1-7   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                             
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,3)=N_COLLOCPOINTS+CONT1-5   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,4)=N_COLLOCPOINTS+CONT1-6  
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,1)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,2)=EDGE_DISCONTINUITY(J,2)  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=0
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,4)=0                                                 
    !                                      
                        QSI(N_ELEM+CONT2-2,1,1)=-0.6D0    
                        QSI(N_ELEM+CONT2-2,1,2)=-0.6D0    
                        QSI(N_ELEM+CONT2-2,2,1)=QSI(J,2,1)  
                        QSI(N_ELEM+CONT2-2,2,2)=QSI(J,2,2)
                        QSI(N_ELEM+CONT2-2,3,1)=0.6D0
                        QSI(N_ELEM+CONT2-2,3,2)=0.6D0    
                        QSI(N_ELEM+CONT2-2,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2-2,4,2)=0.6D0                                   
    !                     
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=NODES_CONNECTIVITY(J,1)   
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=N_NODES+CONT1-3                          
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_NODES+CONT1-2   
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_NODES+CONT1-4
    !
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=COLLOCPOINTS_CONNECTIVITY(J,1)   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=N_COLLOCPOINTS+CONT1-3                              
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_COLLOCPOINTS+CONT1-2   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_COLLOCPOINTS+CONT1-4
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=EDGE_DISCONTINUITY(J,1) 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=0  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=0
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=0                        
    !                                        
                        QSI(N_ELEM+CONT2-1,1,1)=QSI(J,1,1)  
                        QSI(N_ELEM+CONT2-1,1,2)=QSI(J,1,2) 
                        QSI(N_ELEM+CONT2-1,2,1)=0.6D0    
                        QSI(N_ELEM+CONT2-1,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2-1,3,1)=0.6D0
                        QSI(N_ELEM+CONT2-1,3,2)=0.6D0    
                        QSI(N_ELEM+CONT2-1,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2-1,4,2)=0.6D0    
    !                     
                        NODES_CONNECTIVITY(N_ELEM+CONT2,1)=N_NODES+CONT1  
                        NODES_CONNECTIVITY(N_ELEM+CONT2,2)=N_NODES+CONT1-1                          
                        NODES_CONNECTIVITY(N_ELEM+CONT2,3)=NODES_CONNECTIVITY(J,3)   
                        NODES_CONNECTIVITY(N_ELEM+CONT2,4)=NODES_CONNECTIVITY(J,4) 
    !
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=N_COLLOCPOINTS+CONT1    
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=N_COLLOCPOINTS+CONT1-1                              
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=COLLOCPOINTS_CONNECTIVITY(J,3) 
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=COLLOCPOINTS_CONNECTIVITY(J,4)
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=0
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=0  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=EDGE_DISCONTINUITY(J,3)
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=EDGE_DISCONTINUITY(J,4)                          
    !                                        
                        QSI(N_ELEM+CONT2,1,1)=-0.6D0 
                        QSI(N_ELEM+CONT2,1,2)=-0.6D0 
                        QSI(N_ELEM+CONT2,2,1)=0.6D0    
                        QSI(N_ELEM+CONT2,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2,3,1)=QSI(J,3,1)
                        QSI(N_ELEM+CONT2,3,2)=QSI(J,3,2)    
                        QSI(N_ELEM+CONT2,4,1)=QSI(J,4,1)
                        QSI(N_ELEM+CONT2,4,2)=QSI(J,4,2)                                                                                                                                                          
                    ENDIF 
                    IF(CRACKED_EDGES(J,1).EQ.2)THEN
                        CONT2=CONT2+3                           
                        ELEM_TYPE(N_ELEM+CONT2-2)=4         
                        ELEM_TYPE(N_ELEM+CONT2-1)=4
                        ELEM_TYPE(N_ELEM+CONT2)=4                            
    !                   
                        ND(N_ELEM+CONT2-2)=ND(J)  
                        ND(N_ELEM+CONT2-1)=ND(J)
                        ND(N_ELEM+CONT2)=ND(J)                     
    !                    
                        CHANGEABLE_ELEM(N_ELEM+CONT2-2)="CHANGEABLE" 
                        CHANGEABLE_ELEM(N_ELEM+CONT2-1)="CHANGEABLE" 
                        CHANGEABLE_ELEM(N_ELEM+CONT2)="CHANGEABLE"  
    !
                        NEW_ELEMENTS(J,1)=N_ELEM+CONT2-2  
                        NEW_ELEMENTS(J,2)=N_ELEM+CONT2-1
                        NEW_ELEMENTS(J,3)=N_ELEM+CONT2                                                                                                                                                        
    !                    
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_NODES+CONT1-6     
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_NODES+CONT1-7                             
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,3)=NODES_CONNECTIVITY(J,3)    
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,4)=N_NODES+CONT1-5     
    !                    
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_COLLOCPOINTS+CONT1-6   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_COLLOCPOINTS+CONT1-7                                
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,3)=COLLOCPOINTS_CONNECTIVITY(J,3)
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,4)=N_COLLOCPOINTS+CONT1-5
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,1)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,2)=0  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=EDGE_DISCONTINUITY(J,3)
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,4)=0                             
    !                                      
                        QSI(N_ELEM+CONT2-2,1,1)=-0.6D0    
                        QSI(N_ELEM+CONT2-2,1,2)=-0.6D0    
                        QSI(N_ELEM+CONT2-2,2,1)=0.6D0
                        QSI(N_ELEM+CONT2-2,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2-2,3,1)=QSI(J,3,1)  
                        QSI(N_ELEM+CONT2-2,3,2)=QSI(J,3,2)      
                        QSI(N_ELEM+CONT2-2,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2-2,4,2)=0.6D0                                   
    !                     
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=N_NODES+CONT1-4   
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=NODES_CONNECTIVITY(J,2)                             
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_NODES+CONT1-3   
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_NODES+CONT1-2
    !
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=N_COLLOCPOINTS+CONT1-4     
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                                 
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_COLLOCPOINTS+CONT1-3   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_COLLOCPOINTS+CONT1-2
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=EDGE_DISCONTINUITY(J,2)  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=0
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=0                         
    !                                        
                        QSI(N_ELEM+CONT2-1,1,1)=-0.6D0
                        QSI(N_ELEM+CONT2-1,1,2)=-0.6D0
                        QSI(N_ELEM+CONT2-1,2,1)=QSI(J,2,1)    
                        QSI(N_ELEM+CONT2-1,2,2)=QSI(J,2,2)
                        QSI(N_ELEM+CONT2-1,3,1)=0.6D0
                        QSI(N_ELEM+CONT2-1,3,2)=0.6D0    
                        QSI(N_ELEM+CONT2-1,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2-1,4,2)=0.6D0    
    !                     
                        NODES_CONNECTIVITY(N_ELEM+CONT2,1)=NODES_CONNECTIVITY(J,1)    
                        NODES_CONNECTIVITY(N_ELEM+CONT2,2)=N_NODES+CONT1                          
                        NODES_CONNECTIVITY(N_ELEM+CONT2,3)=N_NODES+CONT1-1   
                        NODES_CONNECTIVITY(N_ELEM+CONT2,4)=NODES_CONNECTIVITY(J,4) 
    !
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=COLLOCPOINTS_CONNECTIVITY(J,1)    
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=N_COLLOCPOINTS+CONT1                              
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=N_COLLOCPOINTS+CONT1-1  
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=COLLOCPOINTS_CONNECTIVITY(J,4)
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=EDGE_DISCONTINUITY(J,1)  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=0
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=EDGE_DISCONTINUITY(J,4)                          
    !                                        
                        QSI(N_ELEM+CONT2,1,1)=QSI(J,1,1)
                        QSI(N_ELEM+CONT2,1,2)=QSI(J,1,2)
                        QSI(N_ELEM+CONT2,2,1)=0.6D0    
                        QSI(N_ELEM+CONT2,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2,3,1)=0.6D0 
                        QSI(N_ELEM+CONT2,3,2)=0.6D0    
                        QSI(N_ELEM+CONT2,4,1)=QSI(J,4,1)
                        QSI(N_ELEM+CONT2,4,2)=QSI(J,4,2)                                       
                    ENDIF                          
                    IF(CRACKED_EDGES(J,1).EQ.3)THEN
                        CONT2=CONT2+3                           
                        ELEM_TYPE(N_ELEM+CONT2-2)=4         
                        ELEM_TYPE(N_ELEM+CONT2-1)=4
                        ELEM_TYPE(N_ELEM+CONT2)=4                            
    !                   
                        ND(N_ELEM+CONT2-2)=ND(J)  
                        ND(N_ELEM+CONT2-1)=ND(J)
                        ND(N_ELEM+CONT2)=ND(J)                     
    !                    
                        CHANGEABLE_ELEM(N_ELEM+CONT2-2)="CHANGEABLE" 
                        CHANGEABLE_ELEM(N_ELEM+CONT2-1)="CHANGEABLE" 
                        CHANGEABLE_ELEM(N_ELEM+CONT2)="CHANGEABLE"  
    !
                        NEW_ELEMENTS(J,1)=N_ELEM+CONT2-2  
                        NEW_ELEMENTS(J,2)=N_ELEM+CONT2-1
                        NEW_ELEMENTS(J,3)=N_ELEM+CONT2                                                                                                                                                        
    !                    
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_NODES+CONT1-5     
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_NODES+CONT1-6                           
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,3)=N_NODES+CONT1-7   
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,4)=NODES_CONNECTIVITY(J,4)  
    !                    
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,1)=N_COLLOCPOINTS+CONT1-5   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_COLLOCPOINTS+CONT1-6                              
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,3)=N_COLLOCPOINTS+CONT1-7   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,4)=COLLOCPOINTS_CONNECTIVITY(J,4)
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,1)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,2)=0  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=0
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,4)=EDGE_DISCONTINUITY(J,4)                             
    !                                      
                        QSI(N_ELEM+CONT2-2,1,1)=-0.6D0    
                        QSI(N_ELEM+CONT2-2,1,2)=-0.6D0    
                        QSI(N_ELEM+CONT2-2,2,1)=0.6D0  
                        QSI(N_ELEM+CONT2-2,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2-2,3,1)=0.6D0
                        QSI(N_ELEM+CONT2-2,3,2)=0.6D0    
                        QSI(N_ELEM+CONT2-2,4,1)=QSI(J,4,1)  
                        QSI(N_ELEM+CONT2-2,4,2)=QSI(J,4,2)                                  
    !                     
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=N_NODES+CONT1-2   
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=N_NODES+CONT1-4                          
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=NODES_CONNECTIVITY(J,3)
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_NODES+CONT1-3
    !
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=N_COLLOCPOINTS+CONT1-2   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=N_COLLOCPOINTS+CONT1-4                              
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=COLLOCPOINTS_CONNECTIVITY(J,3) 
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=N_COLLOCPOINTS+CONT1-3
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=0  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=EDGE_DISCONTINUITY(J,3)
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=0                        
    !                                        
                        QSI(N_ELEM+CONT2-1,1,1)=-0.6D0
                        QSI(N_ELEM+CONT2-1,1,2)=-0.6D0
                        QSI(N_ELEM+CONT2-1,2,1)=0.6D0    
                        QSI(N_ELEM+CONT2-1,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2-1,3,1)=QSI(J,3,1)  
                        QSI(N_ELEM+CONT2-1,3,2)=QSI(J,3,2)   
                        QSI(N_ELEM+CONT2-1,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2-1,4,2)=0.6D0    
    !                     
                        NODES_CONNECTIVITY(N_ELEM+CONT2,1)=NODES_CONNECTIVITY(J,1) 
                        NODES_CONNECTIVITY(N_ELEM+CONT2,2)=NODES_CONNECTIVITY(J,2)                          
                        NODES_CONNECTIVITY(N_ELEM+CONT2,3)=N_NODES+CONT1 
                        NODES_CONNECTIVITY(N_ELEM+CONT2,4)=N_NODES+CONT1-1  
    !
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=COLLOCPOINTS_CONNECTIVITY(J,1)    
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                            
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=N_COLLOCPOINTS+CONT1 
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=N_COLLOCPOINTS+CONT1-1
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=EDGE_DISCONTINUITY(J,1) 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=EDGE_DISCONTINUITY(J,2)  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=0
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=0                         
    !                                        
                        QSI(N_ELEM+CONT2,1,1)=QSI(J,1,1)
                        QSI(N_ELEM+CONT2,1,2)=QSI(J,1,2)  
                        QSI(N_ELEM+CONT2,2,1)=QSI(J,2,1)
                        QSI(N_ELEM+CONT2,2,2)=QSI(J,2,2)
                        QSI(N_ELEM+CONT2,3,1)=0.6D0
                        QSI(N_ELEM+CONT2,3,2)=0.6D0    
                        QSI(N_ELEM+CONT2,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2,4,2)=0.6D0                                                           
                    ENDIF
                    IF(CRACKED_EDGES(J,1).EQ.4)THEN                
                        CONT2=CONT2+3                           
                        ELEM_TYPE(N_ELEM+CONT2-2)=4         
                        ELEM_TYPE(N_ELEM+CONT2-1)=4
                        ELEM_TYPE(N_ELEM+CONT2)=4                            
    !                   
                        ND(N_ELEM+CONT2-2)=ND(J)  
                        ND(N_ELEM+CONT2-1)=ND(J)
                        ND(N_ELEM+CONT2)=ND(J)                    
    !                    
                        CHANGEABLE_ELEM(N_ELEM+CONT2-2)="CHANGEABLE" 
                        CHANGEABLE_ELEM(N_ELEM+CONT2-1)="CHANGEABLE" 
                        CHANGEABLE_ELEM(N_ELEM+CONT2)="CHANGEABLE"   
    !
                        NEW_ELEMENTS(J,1)=N_ELEM+CONT2-2  
                        NEW_ELEMENTS(J,2)=N_ELEM+CONT2-1
                        NEW_ELEMENTS(J,3)=N_ELEM+CONT2                                                                                                                                                       
    !                    
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,1)=NODES_CONNECTIVITY(J,1)       
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_NODES+CONT1-5                             
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,3)=N_NODES+CONT1-6     
                        NODES_CONNECTIVITY(N_ELEM+CONT2-2,4)=N_NODES+CONT1-7     
    !                    
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,1)=COLLOCPOINTS_CONNECTIVITY(J,1)  
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,2)=N_COLLOCPOINTS+CONT1-5                                
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,3)=N_COLLOCPOINTS+CONT1-6
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-2,4)=N_COLLOCPOINTS+CONT1-7 
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,1)=EDGE_DISCONTINUITY(J,1) 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,2)=0  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,3)=0
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-2,4)=0                          
    !                                      
                        QSI(N_ELEM+CONT2-2,1,1)=QSI(J,1,1)      
                        QSI(N_ELEM+CONT2-2,1,2)=QSI(J,1,2) 
                        QSI(N_ELEM+CONT2-2,2,1)=0.6D0
                        QSI(N_ELEM+CONT2-2,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2-2,3,1)=0.6D0  
                        QSI(N_ELEM+CONT2-2,3,2)=0.6D0      
                        QSI(N_ELEM+CONT2-2,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2-2,4,2)=0.6D0                                   
    !                     
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=N_NODES+CONT1-3   
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=N_NODES+CONT1-2                         
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_NODES+CONT1-4   
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=NODES_CONNECTIVITY(J,4)    
    !
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=N_COLLOCPOINTS+CONT1-3     
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=N_COLLOCPOINTS+CONT1-2                                  
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=N_COLLOCPOINTS+CONT1-4   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=COLLOCPOINTS_CONNECTIVITY(J,4)
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=0  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=0
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=EDGE_DISCONTINUITY(J,4)                         
    !                                        
                        QSI(N_ELEM+CONT2-1,1,1)=-0.6D0
                        QSI(N_ELEM+CONT2-1,1,2)=-0.6D0
                        QSI(N_ELEM+CONT2-1,2,1)=0.6D0    
                        QSI(N_ELEM+CONT2-1,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2-1,3,1)=0.6D0
                        QSI(N_ELEM+CONT2-1,3,2)=0.6D0    
                        QSI(N_ELEM+CONT2-1,4,1)=QSI(J,4,1) 
                        QSI(N_ELEM+CONT2-1,4,2)=QSI(J,4,2) 
    !                     
                        NODES_CONNECTIVITY(N_ELEM+CONT2,1)=N_NODES+CONT1-1     
                        NODES_CONNECTIVITY(N_ELEM+CONT2,2)=NODES_CONNECTIVITY(J,2)                         
                        NODES_CONNECTIVITY(N_ELEM+CONT2,3)=NODES_CONNECTIVITY(J,3)    
                        NODES_CONNECTIVITY(N_ELEM+CONT2,4)=N_NODES+CONT1 
    !
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=N_COLLOCPOINTS+CONT1-1      
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                          
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=COLLOCPOINTS_CONNECTIVITY(J,3)  
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=N_COLLOCPOINTS+CONT1  
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=EDGE_DISCONTINUITY(J,2)  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=EDGE_DISCONTINUITY(J,3)
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=0                         
    !                                        
                        QSI(N_ELEM+CONT2,1,1)=-0.6D0
                        QSI(N_ELEM+CONT2,1,2)=-0.6D0
                        QSI(N_ELEM+CONT2,2,1)=QSI(J,2,1)  
                        QSI(N_ELEM+CONT2,2,2)=QSI(J,2,2)
                        QSI(N_ELEM+CONT2,3,1)=QSI(J,3,1) 
                        QSI(N_ELEM+CONT2,3,2)=QSI(J,3,2)    
                        QSI(N_ELEM+CONT2,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2,4,2)=0.6D0                                                                                                                                       
                    ENDIF                
                ENDSELECT                                                   
            ELSE
                CONT1=CONT1+4
                DELEM=10000000
                DO K=1,N_ELEM
                    IF(PREVIOUS_CRACKED_ELEM(K).EQ."CRACKTIP".AND.K.NE.J)THEN
                        DELEM_AUX=ABS(J-K)
                        IF(DELEM_AUX.LE.DELEM)THEN
                            DELEM=DELEM_AUX
                            ELEM=K                    
                        ENDIF
                    ENDIF
                ENDDO
    !            
                ELEM1=PREVIOUS_NEW_ELEMENTS(ELEM,1)
                ELEM2=PREVIOUS_NEW_ELEMENTS(ELEM,2)
                ELEM3=PREVIOUS_NEW_ELEMENTS(ELEM,3)
    !                    
                CHANGEABLE_ELEM(ELEM3)="CHANGED"                                               
    !                                              
                IF(PREVIOUS_CRACKED_EDGES(ELEM,1).EQ.1)THEN  
                    NODE1=PREVIOUS_NODES_CONNECTIVITY(ELEM2,2)
                    NODE2=PREVIOUS_NODES_CONNECTIVITY(ELEM2,3)
                    NODE3=PREVIOUS_NODES_CONNECTIVITY(ELEM3,2)   
                    NODE4=PREVIOUS_NODES_CONNECTIVITY(ELEM3,1)      
    !
                    CP1=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM2,2)
                    CP2=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM2,3)
                    CP3=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM3,2)   
                    CP4=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM3,1)
                    CHANGEABLE_COLLOCPOINTS(CP1)="CHANGED"   
                    CHANGEABLE_COLLOCPOINTS(CP2)="CHANGED"  
                    CHANGEABLE_COLLOCPOINTS(CP3)="CHANGED"   
                    CHANGEABLE_COLLOCPOINTS(CP4)="CHANGED"                                                   
                ENDIF 
                IF(PREVIOUS_CRACKED_EDGES(ELEM,1).EQ.2)THEN  
                    NODE1=PREVIOUS_NODES_CONNECTIVITY(ELEM2,3)
                    NODE2=PREVIOUS_NODES_CONNECTIVITY(ELEM2,4)
                    NODE3=PREVIOUS_NODES_CONNECTIVITY(ELEM3,3)   
                    NODE4=PREVIOUS_NODES_CONNECTIVITY(ELEM3,2)                      
    !
                    CP1=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM2,3)
                    CP2=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM2,4)
                    CP3=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM3,3)   
                    CP4=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM3,2)  
                    CHANGEABLE_COLLOCPOINTS(CP1)="CHANGED"   
                    CHANGEABLE_COLLOCPOINTS(CP2)="CHANGED"  
                    CHANGEABLE_COLLOCPOINTS(CP3)="CHANGED"   
                    CHANGEABLE_COLLOCPOINTS(CP4)="CHANGED"                      
                ENDIF
                IF(PREVIOUS_CRACKED_EDGES(ELEM,1).EQ.3)THEN
                    NODE1=PREVIOUS_NODES_CONNECTIVITY(ELEM2,4)
                    NODE2=PREVIOUS_NODES_CONNECTIVITY(ELEM2,1)
                    NODE3=PREVIOUS_NODES_CONNECTIVITY(ELEM3,4)   
                    NODE4=PREVIOUS_NODES_CONNECTIVITY(ELEM3,3)                   
    !
                    CP1=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM2,4)
                    CP2=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM2,1)
                    CP3=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM3,4)   
                    CP4=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM3,3)
                    CHANGEABLE_COLLOCPOINTS(CP1)="CHANGED"   
                    CHANGEABLE_COLLOCPOINTS(CP2)="CHANGED"  
                    CHANGEABLE_COLLOCPOINTS(CP3)="CHANGED"   
                    CHANGEABLE_COLLOCPOINTS(CP4)="CHANGED"                        
                ENDIF
                IF(PREVIOUS_CRACKED_EDGES(ELEM,1).EQ.4)THEN
                    NODE1=PREVIOUS_NODES_CONNECTIVITY(ELEM2,1)
                    NODE2=PREVIOUS_NODES_CONNECTIVITY(ELEM2,2)
                    NODE3=PREVIOUS_NODES_CONNECTIVITY(ELEM3,1)   
                    NODE4=PREVIOUS_NODES_CONNECTIVITY(ELEM3,4)                      
    !
                    CP1=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM2,1)
                    CP2=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM2,2)
                    CP3=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM3,1)   
                    CP4=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM3,4)  
                    CHANGEABLE_COLLOCPOINTS(CP1)="CHANGED"   
                    CHANGEABLE_COLLOCPOINTS(CP2)="CHANGED"  
                    CHANGEABLE_COLLOCPOINTS(CP3)="CHANGED"   
                    CHANGEABLE_COLLOCPOINTS(CP4)="CHANGED"                      
                ENDIF
    !                                                     
                COORD_NODES(NODE1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                COORD_NODES(NODE2,:)=COORD_BOUNDARYCRACKTIP(J,:)    
                COORD_NODES(NODE3,:)=COORD_BOUNDARYCRACKTIPSTOP(J,1,:)
                COORD_NODES(NODE4,:)=COORD_BOUNDARYCRACKTIPSTOP(J,2,:)                                                                                                                                
                COORD_NODES(N_NODES+CONT1-3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                COORD_NODES(N_NODES+CONT1-2,:)=COORD_BOUNDARYCRACKTIP(J,:)      
                COORD_NODES(N_NODES+CONT1-1,:)=COORD_BOUNDARYCRACKTIPSTOP(J,1,:)
                COORD_NODES(N_NODES+CONT1,:)=COORD_BOUNDARYCRACKTIPSTOP(J,2,:)
    !                                            
                SELECT CASE(ELEM_TYPE(J))
                CASE(4)
                    IF(CRACKED_EDGES(J,1).EQ.1)THEN
                        CONT2=CONT2+2                           
                        ELEM_TYPE(N_ELEM+CONT2-1)=4         
                        ELEM_TYPE(N_ELEM+CONT2)=4
                        ELEM_TYPE(ELEM3)=4                            
    !                   
                        ND(N_ELEM+CONT2-1)=ND(J)  
                        ND(N_ELEM+CONT2)=ND(J)
                        ND(ELEM3)=ND(J)                     
    !                    
                        CHANGEABLE_ELEM(N_ELEM+CONT2-1)="CHANGEABLE" 
                        CHANGEABLE_ELEM(N_ELEM+CONT2)="CHANGEABLE" 
    !
                        NEW_ELEMENTS(J,1)=N_ELEM+CONT2-1  
                        NEW_ELEMENTS(J,2)=N_ELEM+CONT2
                        NEW_ELEMENTS(J,3)=ELEM3                                                                                                                                                                                                          
    !                    
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=NODE1     
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=NODES_CONNECTIVITY(J,2)                             
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=NODE3   
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=NODE2     
    !                    
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=CP1   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                             
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=CP3   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=CP2
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=0
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=EDGE_DISCONTINUITY(J,2)  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=0
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=0                             
    !                                      
                        QSI(N_ELEM+CONT2-1,1,1)=-0.6D0    
                        QSI(N_ELEM+CONT2-1,1,2)=-0.6D0    
                        QSI(N_ELEM+CONT2-1,2,1)=QSI(J,2,1)  
                        QSI(N_ELEM+CONT2-1,2,2)=QSI(J,2,2)
                        QSI(N_ELEM+CONT2-1,3,1)=0.6D0
                        QSI(N_ELEM+CONT2-1,3,2)=0.6D0    
                        QSI(N_ELEM+CONT2-1,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2-1,4,2)=0.6D0                                   
    !                     
                        NODES_CONNECTIVITY(N_ELEM+CONT2,1)=NODES_CONNECTIVITY(J,1)   
                        NODES_CONNECTIVITY(N_ELEM+CONT2,2)=N_NODES+CONT1-3                          
                        NODES_CONNECTIVITY(N_ELEM+CONT2,3)=N_NODES+CONT1-2   
                        NODES_CONNECTIVITY(N_ELEM+CONT2,4)=NODE4
    !
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=COLLOCPOINTS_CONNECTIVITY(J,1)   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=N_COLLOCPOINTS+CONT1-3                              
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=N_COLLOCPOINTS+CONT1-2   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=CP4
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=EDGE_DISCONTINUITY(J,1) 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=0  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=0                         
    !                                        
                        QSI(N_ELEM+CONT2,1,1)=QSI(J,1,1)  
                        QSI(N_ELEM+CONT2,1,2)=QSI(J,1,2) 
                        QSI(N_ELEM+CONT2,2,1)=0.6D0    
                        QSI(N_ELEM+CONT2,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2,3,1)=0.6D0
                        QSI(N_ELEM+CONT2,3,2)=0.6D0    
                        QSI(N_ELEM+CONT2,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2,4,2)=0.6D0    
    !                     
                        NODES_CONNECTIVITY(ELEM3,1)=N_NODES+CONT1  
                        NODES_CONNECTIVITY(ELEM3,2)=N_NODES+CONT1-1                          
                        NODES_CONNECTIVITY(ELEM3,3)=NODES_CONNECTIVITY(J,3)   
                        NODES_CONNECTIVITY(ELEM3,4)=NODES_CONNECTIVITY(J,4) 
    !
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,1)=N_COLLOCPOINTS+CONT1    
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,2)=N_COLLOCPOINTS+CONT1-1                              
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,3)=COLLOCPOINTS_CONNECTIVITY(J,3) 
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,4)=COLLOCPOINTS_CONNECTIVITY(J,4)
    !                    
                        EDGE_DISCONTINUITY(ELEM3,1)=0 
                        EDGE_DISCONTINUITY(ELEM3,2)=0  
                        EDGE_DISCONTINUITY(ELEM3,3)=EDGE_DISCONTINUITY(J,3) 
                        EDGE_DISCONTINUITY(ELEM3,4)=EDGE_DISCONTINUITY(J,4)                         
    !                                        
                        QSI(ELEM3,1,1)=-0.6D0 
                        QSI(ELEM3,1,2)=-0.6D0 
                        QSI(ELEM3,2,1)=0.6D0    
                        QSI(ELEM3,2,2)=-0.6D0
                        QSI(ELEM3,3,1)=QSI(J,3,1)
                        QSI(ELEM3,3,2)=QSI(J,3,2)    
                        QSI(ELEM3,4,1)=QSI(J,4,1)
                        QSI(ELEM3,4,2)=QSI(J,4,2)                                                                            
    ! 
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-3)="CHANGEABLE"   
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-2)="CHANGEABLE"  
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-1)="CHANGEABLE"   
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1)="CHANGEABLE"                                                                                                                                                           
                    ENDIF  
                    IF(CRACKED_EDGES(J,1).EQ.2)THEN
                        CONT2=CONT2+2                           
                        ELEM_TYPE(N_ELEM+CONT2-1)=4         
                        ELEM_TYPE(N_ELEM+CONT2)=4
                        ELEM_TYPE(ELEM3)=4                            
    !                   
                        ND(N_ELEM+CONT2-1)=ND(J)  
                        ND(N_ELEM+CONT2)=ND(J)
                        ND(ELEM3)=ND(J)                    
    !                    
                        CHANGEABLE_ELEM(N_ELEM+CONT2-1)="CHANGEABLE" 
                        CHANGEABLE_ELEM(N_ELEM+CONT2)="CHANGEABLE" 
    !
                        NEW_ELEMENTS(J,1)=N_ELEM+CONT2-1  
                        NEW_ELEMENTS(J,2)=N_ELEM+CONT2
                        NEW_ELEMENTS(J,3)=ELEM3                                                                                                                                                            
    !                    
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=NODE2     
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=NODE1                             
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=NODES_CONNECTIVITY(J,3)    
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=NODE3     
    !                    
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=CP2   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=CP1                                
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=COLLOCPOINTS_CONNECTIVITY(J,3)
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=CP3
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=0
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=EDGE_DISCONTINUITY(J,3)  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=0                             
    !                                      
                        QSI(N_ELEM+CONT2-1,1,1)=-0.6D0    
                        QSI(N_ELEM+CONT2-1,1,2)=-0.6D0    
                        QSI(N_ELEM+CONT2-1,2,1)=0.6D0
                        QSI(N_ELEM+CONT2-1,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2-1,3,1)=QSI(J,3,1)  
                        QSI(N_ELEM+CONT2-1,3,2)=QSI(J,3,2)      
                        QSI(N_ELEM+CONT2-1,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2-1,4,2)=0.6D0                                   
    !                     
                        NODES_CONNECTIVITY(N_ELEM+CONT2,1)=NODE4   
                        NODES_CONNECTIVITY(N_ELEM+CONT2,2)=NODES_CONNECTIVITY(J,2)                             
                        NODES_CONNECTIVITY(N_ELEM+CONT2,3)=N_NODES+CONT1-3   
                        NODES_CONNECTIVITY(N_ELEM+CONT2,4)=N_NODES+CONT1-2
    !
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=CP4     
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                                 
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=N_COLLOCPOINTS+CONT1-3   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=N_COLLOCPOINTS+CONT1-2
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=EDGE_DISCONTINUITY(J,2)  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=0                         
    !                                        
                        QSI(N_ELEM+CONT2,1,1)=-0.6D0
                        QSI(N_ELEM+CONT2,1,2)=-0.6D0
                        QSI(N_ELEM+CONT2,2,1)=QSI(J,2,1)    
                        QSI(N_ELEM+CONT2,2,2)=QSI(J,2,2)
                        QSI(N_ELEM+CONT2,3,1)=0.6D0
                        QSI(N_ELEM+CONT2,3,2)=0.6D0    
                        QSI(N_ELEM+CONT2,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2,4,2)=0.6D0    
    !                     
                        NODES_CONNECTIVITY(ELEM3,1)=NODES_CONNECTIVITY(J,1)    
                        NODES_CONNECTIVITY(ELEM3,2)=N_NODES+CONT1                          
                        NODES_CONNECTIVITY(ELEM3,3)=N_NODES+CONT1-1   
                        NODES_CONNECTIVITY(ELEM3,4)=NODES_CONNECTIVITY(J,4) 
    !
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,1)=COLLOCPOINTS_CONNECTIVITY(J,1)    
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,2)=N_COLLOCPOINTS+CONT1                              
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,3)=N_COLLOCPOINTS+CONT1-1  
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,4)=COLLOCPOINTS_CONNECTIVITY(J,4) 
    !                    
                        EDGE_DISCONTINUITY(ELEM3,1)=EDGE_DISCONTINUITY(J,1) 
                        EDGE_DISCONTINUITY(ELEM3,2)=0  
                        EDGE_DISCONTINUITY(ELEM3,3)=0 
                        EDGE_DISCONTINUITY(ELEM3,4)=EDGE_DISCONTINUITY(J,4)                         
    !                                        
                        QSI(ELEM3,1,1)=QSI(J,1,1)
                        QSI(ELEM3,1,2)=QSI(J,1,2)
                        QSI(ELEM3,2,1)=0.6D0    
                        QSI(ELEM3,2,2)=-0.6D0
                        QSI(ELEM3,3,1)=0.6D0 
                        QSI(ELEM3,3,2)=0.6D0    
                        QSI(ELEM3,4,1)=QSI(J,4,1)
                        QSI(ELEM3,4,2)=QSI(J,4,2)                
    !
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-3)="CHANGEABLE"   
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-2)="CHANGEABLE"  
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-1)="CHANGEABLE"   
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1)="CHANGEABLE"                                         
                    ENDIF                        
                    IF(CRACKED_EDGES(J,1).EQ.3)THEN
                        CONT2=CONT2+2                           
                        ELEM_TYPE(N_ELEM+CONT2-1)=4         
                        ELEM_TYPE(N_ELEM+CONT2)=4
                        ELEM_TYPE(ELEM3)=4                            
    !                   
                        ND(N_ELEM+CONT2-1)=ND(J)  
                        ND(N_ELEM+CONT2)=ND(J)
                        ND(ELEM3)=ND(J)                    
    !                    
                        CHANGEABLE_ELEM(N_ELEM+CONT2-1)="CHANGEABLE" 
                        CHANGEABLE_ELEM(N_ELEM+CONT2)="CHANGEABLE" 
    !
                        NEW_ELEMENTS(J,1)=N_ELEM+CONT2-1  
                        NEW_ELEMENTS(J,2)=N_ELEM+CONT2
                        NEW_ELEMENTS(J,3)=ELEM3                                                                                                                                                           
    !                    
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=NODE3     
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=NODE2                           
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=NODE1   
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=NODES_CONNECTIVITY(J,4)  
    !                    
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=CP3   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=CP2                              
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=CP1   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=COLLOCPOINTS_CONNECTIVITY(J,4) 
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=0  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=EDGE_DISCONTINUITY(J,4)                           
    !                                      
                        QSI(N_ELEM+CONT2-1,1,1)=-0.6D0    
                        QSI(N_ELEM+CONT2-1,1,2)=-0.6D0    
                        QSI(N_ELEM+CONT2-1,2,1)=0.6D0  
                        QSI(N_ELEM+CONT2-1,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2-1,3,1)=0.6D0
                        QSI(N_ELEM+CONT2-1,3,2)=0.6D0    
                        QSI(N_ELEM+CONT2-1,4,1)=QSI(J,4,1)  
                        QSI(N_ELEM+CONT2-1,4,2)=QSI(J,4,2)                                  
    !                     
                        NODES_CONNECTIVITY(N_ELEM+CONT2,1)=N_NODES+CONT1-2   
                        NODES_CONNECTIVITY(N_ELEM+CONT2,2)=NODE4                          
                        NODES_CONNECTIVITY(N_ELEM+CONT2,3)=NODES_CONNECTIVITY(J,3)
                        NODES_CONNECTIVITY(N_ELEM+CONT2,4)=N_NODES+CONT1-3
    !
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=N_COLLOCPOINTS+CONT1-2   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=CP4                              
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=COLLOCPOINTS_CONNECTIVITY(J,3) 
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=N_COLLOCPOINTS+CONT1-3
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=0   
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=EDGE_DISCONTINUITY(J,3)  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=0                       
    !                                        
                        QSI(N_ELEM+CONT2,1,1)=-0.6D0
                        QSI(N_ELEM+CONT2,1,2)=-0.6D0
                        QSI(N_ELEM+CONT2,2,1)=0.6D0    
                        QSI(N_ELEM+CONT2,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2,3,1)=QSI(J,3,1)  
                        QSI(N_ELEM+CONT2,3,2)=QSI(J,3,2)   
                        QSI(N_ELEM+CONT2,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2,4,2)=0.6D0    
    !                     
                        NODES_CONNECTIVITY(ELEM3,1)=NODES_CONNECTIVITY(J,1) 
                        NODES_CONNECTIVITY(ELEM3,2)=NODES_CONNECTIVITY(J,2)                          
                        NODES_CONNECTIVITY(ELEM3,3)=N_NODES+CONT1 
                        NODES_CONNECTIVITY(ELEM3,4)=N_NODES+CONT1-1  
    !
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,1)=COLLOCPOINTS_CONNECTIVITY(J,1)    
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                            
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,3)=N_COLLOCPOINTS+CONT1 
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,4)=N_COLLOCPOINTS+CONT1-1 
    !                    
                        EDGE_DISCONTINUITY(ELEM3,1)=EDGE_DISCONTINUITY(J,1) 
                        EDGE_DISCONTINUITY(ELEM3,2)=EDGE_DISCONTINUITY(J,2)   
                        EDGE_DISCONTINUITY(ELEM3,3)=0 
                        EDGE_DISCONTINUITY(ELEM3,4)=0                           
    !                                        
                        QSI(ELEM3,1,1)=QSI(J,1,1)
                        QSI(ELEM3,1,2)=QSI(J,1,2)  
                        QSI(ELEM3,2,1)=QSI(J,2,1)
                        QSI(ELEM3,2,2)=QSI(J,2,2)
                        QSI(ELEM3,3,1)=0.6D0
                        QSI(ELEM3,3,2)=0.6D0    
                        QSI(ELEM3,4,1)=-0.6D0
                        QSI(ELEM3,4,2)=0.6D0                              
    !
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-3)="CHANGEABLE"   
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-2)="CHANGEABLE"  
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-1)="CHANGEABLE"   
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1)="CHANGEABLE"                                                        
                    ENDIF
                    IF(CRACKED_EDGES(J,1).EQ.4)THEN                
                        CONT2=CONT2+2                           
                        ELEM_TYPE(N_ELEM+CONT2-1)=4         
                        ELEM_TYPE(N_ELEM+CONT2)=4
                        ELEM_TYPE(ELEM3)=4                            
    !                   
                        ND(N_ELEM+CONT2-1)=ND(J)  
                        ND(N_ELEM+CONT2)=ND(J)
                        ND(ELEM3)=ND(J)                    
    !                    
                        CHANGEABLE_ELEM(N_ELEM+CONT2-1)="CHANGEABLE" 
                        CHANGEABLE_ELEM(N_ELEM+CONT2)="CHANGEABLE" 
    !
                        NEW_ELEMENTS(J,1)=N_ELEM+CONT2-1  
                        NEW_ELEMENTS(J,2)=N_ELEM+CONT2
                        NEW_ELEMENTS(J,3)=ELEM3                                                                                                                                                           
    !                    
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,1)=NODES_CONNECTIVITY(J,1)       
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,2)=NODE3                             
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,3)=NODE2     
                        NODES_CONNECTIVITY(N_ELEM+CONT2-1,4)=NODE1     
    !                    
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,1)=COLLOCPOINTS_CONNECTIVITY(J,1)  
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,2)=CP3                                
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,3)=CP2
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2-1,4)=CP1
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,1)=EDGE_DISCONTINUITY(J,1) 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,2)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,3)=0
                        EDGE_DISCONTINUITY(N_ELEM+CONT2-1,4)=0                              
    !                                      
                        QSI(N_ELEM+CONT2-1,1,1)=QSI(J,1,1)      
                        QSI(N_ELEM+CONT2-1,1,2)=QSI(J,1,2) 
                        QSI(N_ELEM+CONT2-1,2,1)=0.6D0
                        QSI(N_ELEM+CONT2-1,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2-1,3,1)=0.6D0  
                        QSI(N_ELEM+CONT2-1,3,2)=0.6D0      
                        QSI(N_ELEM+CONT2-1,4,1)=-0.6D0
                        QSI(N_ELEM+CONT2-1,4,2)=0.6D0                                   
    !                     
                        NODES_CONNECTIVITY(N_ELEM+CONT2,1)=N_NODES+CONT1-3   
                        NODES_CONNECTIVITY(N_ELEM+CONT2,2)=N_NODES+CONT1-2                         
                        NODES_CONNECTIVITY(N_ELEM+CONT2,3)=NODE4   
                        NODES_CONNECTIVITY(N_ELEM+CONT2,4)=NODES_CONNECTIVITY(J,4)    
    !
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=N_COLLOCPOINTS+CONT1-3     
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=N_COLLOCPOINTS+CONT1-2                                  
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=CP4   
                        COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,4)=COLLOCPOINTS_CONNECTIVITY(J,4)
    !                    
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=0  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=0 
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,4)=EDGE_DISCONTINUITY(J,4)                         
    !                                        
                        QSI(N_ELEM+CONT2,1,1)=-0.6D0
                        QSI(N_ELEM+CONT2,1,2)=-0.6D0
                        QSI(N_ELEM+CONT2,2,1)=0.6D0    
                        QSI(N_ELEM+CONT2,2,2)=-0.6D0
                        QSI(N_ELEM+CONT2,3,1)=0.6D0
                        QSI(N_ELEM+CONT2,3,2)=0.6D0    
                        QSI(N_ELEM+CONT2,4,1)=QSI(J,4,1) 
                        QSI(N_ELEM+CONT2,4,2)=QSI(J,4,2) 
    !                     
                        NODES_CONNECTIVITY(ELEM3,1)=N_NODES+CONT1-1     
                        NODES_CONNECTIVITY(ELEM3,2)=NODES_CONNECTIVITY(J,2)                         
                        NODES_CONNECTIVITY(ELEM3,3)=NODES_CONNECTIVITY(J,3)    
                        NODES_CONNECTIVITY(ELEM3,4)=N_NODES+CONT1 
    !
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,1)=N_COLLOCPOINTS+CONT1-1      
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                          
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,3)=COLLOCPOINTS_CONNECTIVITY(J,3)  
                        COLLOCPOINTS_CONNECTIVITY(ELEM3,4)=N_COLLOCPOINTS+CONT1 
    !                    
                        EDGE_DISCONTINUITY(ELEM3,1)=0
                        EDGE_DISCONTINUITY(ELEM3,2)=EDGE_DISCONTINUITY(J,2)   
                        EDGE_DISCONTINUITY(ELEM3,3)=EDGE_DISCONTINUITY(J,3)  
                        EDGE_DISCONTINUITY(ELEM3,4)=0                          
    !                                        
                        QSI(ELEM3,1,1)=-0.6D0
                        QSI(ELEM3,1,2)=-0.6D0
                        QSI(ELEM3,2,1)=QSI(J,2,1)  
                        QSI(ELEM3,2,2)=QSI(J,2,2)
                        QSI(ELEM3,3,1)=QSI(J,3,1) 
                        QSI(ELEM3,3,2)=QSI(J,3,2)    
                        QSI(ELEM3,4,1)=-0.6D0
                        QSI(ELEM3,4,2)=0.6D0                          
    ! 
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-3)="CHANGEABLE"   
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-2)="CHANGEABLE"  
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1-1)="CHANGEABLE"   
                        CHANGEABLE_COLLOCPOINTS(N_COLLOCPOINTS+CONT1)="CHANGEABLE"                                                                                                                                   
                    ENDIF                
                ENDSELECT
            ENDIF
        ELSE IF(PREVIOUS_CRACKED_ELEM(J).EQ."CRACKTIP".AND.CRACKED_ELEM(J).EQ."CRACKED")THEN
!                    
            ELEM1=NEW_ELEMENTS(J,1)
            ELEM2=NEW_ELEMENTS(J,2)
            ELEM3=NEW_ELEMENTS(J,3)
!                    
            CHANGEABLE_ELEM(ELEM1)="CHANGED" 
            CHANGEABLE_ELEM(ELEM2)="CHANGED"                                               
!                                              
            IF(PREVIOUS_CRACKED_EDGES(J,1).EQ.1)THEN  
                NODE1=PREVIOUS_NODES_CONNECTIVITY(ELEM1,1)
                NODE2=PREVIOUS_NODES_CONNECTIVITY(ELEM1,4)
                NODE3=PREVIOUS_NODES_CONNECTIVITY(ELEM1,3)   
                NODE4=PREVIOUS_NODES_CONNECTIVITY(ELEM2,4)      
!
                CP1=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM1,1)
                CP2=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM1,4)
                CP3=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM1,3)   
                CP4=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM2,4)
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGED"  
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGED"                                                   
            ENDIF 
            IF(PREVIOUS_CRACKED_EDGES(J,1).EQ.2)THEN  
                NODE1=PREVIOUS_NODES_CONNECTIVITY(ELEM1,2)
                NODE2=PREVIOUS_NODES_CONNECTIVITY(ELEM1,1)
                NODE3=PREVIOUS_NODES_CONNECTIVITY(ELEM1,4)   
                NODE4=PREVIOUS_NODES_CONNECTIVITY(ELEM2,1)                      
!
                CP1=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM1,2)
                CP2=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM1,1)
                CP3=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM1,4)   
                CP4=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM2,1)  
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGED"  
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGED"                      
            ENDIF
            IF(PREVIOUS_CRACKED_EDGES(J,1).EQ.3)THEN
                NODE1=PREVIOUS_NODES_CONNECTIVITY(ELEM1,3)
                NODE2=PREVIOUS_NODES_CONNECTIVITY(ELEM1,2)
                NODE3=PREVIOUS_NODES_CONNECTIVITY(ELEM1,1)   
                NODE4=PREVIOUS_NODES_CONNECTIVITY(ELEM2,2)                   
!
                CP1=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM1,3)
                CP2=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM1,2)
                CP3=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM1,1)   
                CP4=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM2,2)
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGED"  
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGED"                        
            ENDIF
            IF(PREVIOUS_CRACKED_EDGES(J,1).EQ.4)THEN
                NODE1=PREVIOUS_NODES_CONNECTIVITY(ELEM1,4)
                NODE2=PREVIOUS_NODES_CONNECTIVITY(ELEM1,3)
                NODE3=PREVIOUS_NODES_CONNECTIVITY(ELEM1,2)   
                NODE4=PREVIOUS_NODES_CONNECTIVITY(ELEM2,3)                      
!
                CP1=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM1,4)
                CP2=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM1,3)
                CP3=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM1,2)   
                CP4=PREVIOUS_COLLOCPOINTS_CONNECTIVITY(ELEM2,3)  
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGED"  
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGED"                      
            ENDIF                                                                                                                               
!
            SELECT CASE(ELEM_TYPE(J))
            CASE(4)
                IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.3)THEN 
!                                                     
                    COORD_NODES(NODE1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(NODE2,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)      
                    COORD_NODES(NODE3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(NODE4,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:) 
!                                                      
                    ELEM_TYPE(ELEM1)=4         
                    ELEM_TYPE(ELEM2)=4
!                   
                    ND(ELEM1)=ND(J)  
                    ND(ELEM2)=ND(J)
! 
                    NEW_ELEMENTS(J,1)=ELEM1
                    NEW_ELEMENTS(J,2)=ELEM2                                                                                                                      
!                    
                    NODES_CONNECTIVITY(ELEM1,1)=NODES_CONNECTIVITY(J,1)   
                    NODES_CONNECTIVITY(ELEM1,4)=NODES_CONNECTIVITY(J,4)                             
                    NODES_CONNECTIVITY(ELEM1,2)=NODE1   
                    NODES_CONNECTIVITY(ELEM1,3)=NODE2  
!                    
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,1)=COLLOCPOINTS_CONNECTIVITY(J,1)   
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,4)=COLLOCPOINTS_CONNECTIVITY(J,4)                             
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,2)=CP1   
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,3)=CP2
!                    
                    EDGE_DISCONTINUITY(ELEM1,1)=EDGE_DISCONTINUITY(J,1) 
                    EDGE_DISCONTINUITY(ELEM1,4)=EDGE_DISCONTINUITY(J,4)   
                    EDGE_DISCONTINUITY(ELEM1,2)=0
                    EDGE_DISCONTINUITY(ELEM1,3)=0                        
!                                      
                    QSI(ELEM1,1,1)=QSI(J,1,1)  
                    QSI(ELEM1,1,2)=QSI(J,1,2) 
                    QSI(ELEM1,4,1)=QSI(J,4,1)  
                    QSI(ELEM1,4,2)=QSI(J,4,2)
                    QSI(ELEM1,2,1)=0.6D0
                    QSI(ELEM1,2,2)=-0.6D0    
                    QSI(ELEM1,3,1)=0.6D0
                    QSI(ELEM1,3,2)=0.6D0                                   
!                     
                    NODES_CONNECTIVITY(ELEM2,2)=NODES_CONNECTIVITY(J,2)   
                    NODES_CONNECTIVITY(ELEM2,3)=NODES_CONNECTIVITY(J,3)                             
                    NODES_CONNECTIVITY(ELEM2,1)=NODE3   
                    NODES_CONNECTIVITY(ELEM2,4)=NODE4
!
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,2)=COLLOCPOINTS_CONNECTIVITY(J,2)   
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,3)=COLLOCPOINTS_CONNECTIVITY(J,3)                             
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,1)=CP3   
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,4)=CP4
!                    
                    EDGE_DISCONTINUITY(ELEM2,2)=EDGE_DISCONTINUITY(J,2) 
                    EDGE_DISCONTINUITY(ELEM2,3)=EDGE_DISCONTINUITY(J,3)   
                    EDGE_DISCONTINUITY(ELEM2,1)=0
                    EDGE_DISCONTINUITY(ELEM2,4)=0                    
!                                        
                    QSI(ELEM2,2,1)=QSI(J,2,1)  
                    QSI(ELEM2,2,2)=QSI(J,2,2) 
                    QSI(ELEM2,3,1)=QSI(J,3,1)  
                    QSI(ELEM2,3,2)=QSI(J,3,2)
                    QSI(ELEM2,1,1)=-0.6D0
                    QSI(ELEM2,1,2)=-0.6D0    
                    QSI(ELEM2,4,1)=-0.6D0
                    QSI(ELEM2,4,2)=0.6D0  
!                                                                                                   
                ENDIF
                IF(CRACKED_EDGES(J,1).EQ.2.AND.CRACKED_EDGES(J,2).EQ.4)THEN 
!                                                     
                    COORD_NODES(NODE1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(NODE2,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)      
                    COORD_NODES(NODE3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(NODE4,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)
!                                        
                    ELEM_TYPE(ELEM1)=4          
                    ELEM_TYPE(ELEM2)=4
!
                    ND(ELEM1)=ND(J)  
                    ND(ELEM2)=ND(J)
! 
                    NEW_ELEMENTS(J,1)=ELEM1
                    NEW_ELEMENTS(J,2)=ELEM2                                                                
!
                    NODES_CONNECTIVITY(ELEM1,1)=NODES_CONNECTIVITY(J,1)   
                    NODES_CONNECTIVITY(ELEM1,2)=NODES_CONNECTIVITY(J,2)                             
                    NODES_CONNECTIVITY(ELEM1,3)=NODE1   
                    NODES_CONNECTIVITY(ELEM1,4)=NODE2  
!
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,1)=COLLOCPOINTS_CONNECTIVITY(J,1)   
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                             
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,3)=CP1   
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,4)=CP2
!                    
                    EDGE_DISCONTINUITY(ELEM1,1)=EDGE_DISCONTINUITY(J,1) 
                    EDGE_DISCONTINUITY(ELEM1,2)=EDGE_DISCONTINUITY(J,2)   
                    EDGE_DISCONTINUITY(ELEM1,3)=0
                    EDGE_DISCONTINUITY(ELEM1,4)=0                  
!                                        
                    QSI(ELEM1,1,1)=QSI(J,1,1)  
                    QSI(ELEM1,1,2)=QSI(J,1,2) 
                    QSI(ELEM1,2,1)=QSI(J,2,1)  
                    QSI(ELEM1,2,2)=QSI(J,2,2)
                    QSI(ELEM1,3,1)=0.6D0
                    QSI(ELEM1,3,2)=0.6D0    
                    QSI(ELEM1,4,1)=-0.6D0
                    QSI(ELEM1,4,2)=0.6D0 
!                       
                    NODES_CONNECTIVITY(ELEM2,3)=NODES_CONNECTIVITY(J,3)   
                    NODES_CONNECTIVITY(ELEM2,4)=NODES_CONNECTIVITY(J,4)                             
                    NODES_CONNECTIVITY(ELEM2,1)=NODE4    
                    NODES_CONNECTIVITY(ELEM2,2)=NODE3 
!
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,3)=COLLOCPOINTS_CONNECTIVITY(J,3)   
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,4)=COLLOCPOINTS_CONNECTIVITY(J,4)                             
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,1)=CP4     
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,2)=CP3
!                    
                    EDGE_DISCONTINUITY(ELEM2,3)=EDGE_DISCONTINUITY(J,3) 
                    EDGE_DISCONTINUITY(ELEM2,4)=EDGE_DISCONTINUITY(J,4)   
                    EDGE_DISCONTINUITY(ELEM2,1)=0
                    EDGE_DISCONTINUITY(ELEM2,2)=0                   
!                                        
                    QSI(ELEM2,3,1)=QSI(J,3,1)  
                    QSI(ELEM2,3,2)=QSI(J,3,2) 
                    QSI(ELEM2,4,1)=QSI(J,4,1)  
                    QSI(ELEM2,4,2)=QSI(J,4,2)
                    QSI(ELEM2,1,1)=-0.6D0
                    QSI(ELEM2,1,2)=-0.6D0    
                    QSI(ELEM2,2,1)=0.6D0
                    QSI(ELEM2,2,2)=-0.6D0 
!                                                                                              
                ENDIF
                IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.2)THEN                 
                    CONT1=CONT1+3
                    COORD_NODES(NODE1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(NODE2,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                      
                    COORD_NODES(N_NODES+CONT1-2,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)
                    COORD_NODES(NODE3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(NODE4,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                                              
                    COORD_NODES(N_NODES+CONT1-1,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)
                    COORD_NODES(N_NODES+CONT1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                
!                         
                    CONT2=CONT2+1        
                    ELEM_TYPE(N_ELEM+CONT2)=3          
                    ELEM_TYPE(ELEM1)=4
                    ELEM_TYPE(ELEM2)=4                    
!
                    ND(N_ELEM+CONT2)=ND(J)
                    ND(ELEM1)=ND(J)  
                    ND(ELEM2)=ND(J)
! 
                    NEW_ELEMENTS(J,1)=N_ELEM+CONT2
                    NEW_ELEMENTS(J,2)=ELEM1
                    NEW_ELEMENTS(J,3)=ELEM2                                                                
!
                    NODES_CONNECTIVITY(N_ELEM+CONT2,1)=NODE2   
                    NODES_CONNECTIVITY(N_ELEM+CONT2,2)=NODE1                             
                    NODES_CONNECTIVITY(N_ELEM+CONT2,3)=NODES_CONNECTIVITY(J,2)    
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=CP2   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=CP1                             
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=COLLOCPOINTS_CONNECTIVITY(J,2)
!                    
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=0 
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=0
                    IF(EDGE_DISCONTINUITY(J,2).EQ.1)THEN      
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=2     
                    ELSE IF(EDGE_DISCONTINUITY(J,2).EQ.2)THEN
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=3   
                    ELSE
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=0
                    ENDIF                 
!                                        
                    QSI(N_ELEM+CONT2,1,1)=0.8D0 
                    QSI(N_ELEM+CONT2,1,2)=0.1D0
                    QSI(N_ELEM+CONT2,2,1)=0.1D0
                    QSI(N_ELEM+CONT2,2,2)=0.8D0
                    QSI(N_ELEM+CONT2,3,1)=0.D0
                    QSI(N_ELEM+CONT2,3,2)=0.D0  
!                    
                    NODES_CONNECTIVITY(ELEM1,1)=NODES_CONNECTIVITY(J,1)   
                    NODES_CONNECTIVITY(ELEM1,2)=NODE3                            
                    NODES_CONNECTIVITY(ELEM1,3)=NODE4    
                    NODES_CONNECTIVITY(ELEM1,4)=N_NODES+CONT1-2 
!
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,1)=COLLOCPOINTS_CONNECTIVITY(J,1)   
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,2)=CP3                              
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,3)=CP4     
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,4)=N_COLLOCPOINTS+CONT1-2
!                    
                    EDGE_DISCONTINUITY(ELEM1,1)=EDGE_DISCONTINUITY(J,1) 
                    EDGE_DISCONTINUITY(ELEM1,2)=0 
                    EDGE_DISCONTINUITY(ELEM1,3)=0
                    EDGE_DISCONTINUITY(ELEM1,4)=0                    
!                                        
                    QSI(ELEM1,1,1)=QSI(J,1,1)  
                    QSI(ELEM1,1,2)=QSI(J,1,2) 
                    QSI(ELEM1,2,1)=0.6D0
                    QSI(ELEM1,2,2)=-0.6D0
                    QSI(ELEM1,3,1)=0.6D0
                    QSI(ELEM1,3,2)=0.6D0    
                    QSI(ELEM1,4,1)=-0.6D0
                    QSI(ELEM1,4,2)=0.6D0  
!                    
                    NODES_CONNECTIVITY(ELEM2,1)=N_NODES+CONT1-1  
                    NODES_CONNECTIVITY(ELEM2,2)=N_NODES+CONT1                            
                    NODES_CONNECTIVITY(ELEM2,3)=NODES_CONNECTIVITY(J,3)     
                    NODES_CONNECTIVITY(ELEM2,4)=NODES_CONNECTIVITY(J,4)   
!
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,1)=N_COLLOCPOINTS+CONT1-1     
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,2)=N_COLLOCPOINTS+CONT1                              
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,3)=COLLOCPOINTS_CONNECTIVITY(J,3)      
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,4)=COLLOCPOINTS_CONNECTIVITY(J,4)
!                    
                    EDGE_DISCONTINUITY(ELEM2,1)=0
                    EDGE_DISCONTINUITY(ELEM2,2)=0 
                    EDGE_DISCONTINUITY(ELEM2,3)=EDGE_DISCONTINUITY(J,3) 
                    EDGE_DISCONTINUITY(ELEM2,4)=EDGE_DISCONTINUITY(J,4)                        
!                                        
                    QSI(ELEM2,1,1)=-0.6D0
                    QSI(ELEM2,1,2)=-0.6D0
                    QSI(ELEM2,2,1)=0.6D0
                    QSI(ELEM2,2,2)=-0.6D0
                    QSI(ELEM2,3,1)=QSI(J,3,1)  
                    QSI(ELEM2,3,2)=QSI(J,3,2) 
                    QSI(ELEM2,4,1)=QSI(J,4,1)  
                    QSI(ELEM2,4,2)=QSI(J,4,2)                  
                ENDIF  
                IF(CRACKED_EDGES(J,1).EQ.2.AND.CRACKED_EDGES(J,2).EQ.3)THEN 
                    CONT1=CONT1+3
                    COORD_NODES(NODE1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(NODE2,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                      
                    COORD_NODES(N_NODES+CONT1-2,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)
                    COORD_NODES(NODE3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(NODE4,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                                              
                    COORD_NODES(N_NODES+CONT1-1,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)
                    COORD_NODES(N_NODES+CONT1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                
!                         
                    CONT2=CONT2+1        
                    ELEM_TYPE(N_ELEM+CONT2)=3          
                    ELEM_TYPE(ELEM1)=4
                    ELEM_TYPE(ELEM2)=4                    
!
                    ND(N_ELEM+CONT2)=ND(J)
                    ND(ELEM1)=ND(J)  
                    ND(ELEM2)=ND(J)
! 
                    NEW_ELEMENTS(J,1)=N_ELEM+CONT2
                    NEW_ELEMENTS(J,2)=ELEM1
                    NEW_ELEMENTS(J,3)=ELEM2                                                                
!
                    NODES_CONNECTIVITY(N_ELEM+CONT2,1)=NODE2   
                    NODES_CONNECTIVITY(N_ELEM+CONT2,2)=NODE1                             
                    NODES_CONNECTIVITY(N_ELEM+CONT2,3)=NODES_CONNECTIVITY(J,3)    
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=CP2   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=CP1                             
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=COLLOCPOINTS_CONNECTIVITY(J,3)
!                    
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=0  
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=0      
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=EDGE_DISCONTINUITY(J,3)                      
!                                        
                    QSI(N_ELEM+CONT2,1,1)=0.8D0 
                    QSI(N_ELEM+CONT2,1,2)=0.1D0
                    QSI(N_ELEM+CONT2,2,1)=0.1D0
                    QSI(N_ELEM+CONT2,2,2)=0.8D0
                    QSI(N_ELEM+CONT2,3,1)=0.D0
                    QSI(N_ELEM+CONT2,3,2)=0.D0  
!                    
                    NODES_CONNECTIVITY(ELEM1,1)=N_NODES+CONT1-2    
                    NODES_CONNECTIVITY(ELEM1,2)=NODES_CONNECTIVITY(J,2)                               
                    NODES_CONNECTIVITY(ELEM1,3)=NODE3    
                    NODES_CONNECTIVITY(ELEM1,4)=NODE4 
!
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,1)=N_COLLOCPOINTS+CONT1-2   
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                              
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,3)=CP3     
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,4)=CP4
!                    
                    EDGE_DISCONTINUITY(ELEM1,1)=0
                    EDGE_DISCONTINUITY(ELEM1,2)=EDGE_DISCONTINUITY(J,2)   
                    EDGE_DISCONTINUITY(ELEM1,3)=0
                    EDGE_DISCONTINUITY(ELEM1,4)=0                           
!                                        
                    QSI(ELEM1,1,1)=-0.6D0
                    QSI(ELEM1,1,2)=-0.6D0 
                    QSI(ELEM1,2,1)=QSI(J,2,1)
                    QSI(ELEM1,2,2)=QSI(J,2,2)
                    QSI(ELEM1,3,1)=0.6D0
                    QSI(ELEM1,3,2)=0.6D0    
                    QSI(ELEM1,4,1)=-0.6D0
                    QSI(ELEM1,4,2)=0.6D0  
!                    
                    NODES_CONNECTIVITY(ELEM2,1)=NODES_CONNECTIVITY(J,1)  
                    NODES_CONNECTIVITY(ELEM2,2)=N_NODES+CONT1-1                            
                    NODES_CONNECTIVITY(ELEM2,3)=N_NODES+CONT1   
                    NODES_CONNECTIVITY(ELEM2,4)=NODES_CONNECTIVITY(J,4)   
!
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,1)=COLLOCPOINTS_CONNECTIVITY(J,1)  
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,2)=N_COLLOCPOINTS+CONT1-1                              
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,3)=N_COLLOCPOINTS+CONT1  
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,4)=COLLOCPOINTS_CONNECTIVITY(J,4) 
!                    
                    EDGE_DISCONTINUITY(ELEM2,1)=EDGE_DISCONTINUITY(J,1)
                    EDGE_DISCONTINUITY(ELEM2,2)=0   
                    EDGE_DISCONTINUITY(ELEM2,3)=0
                    EDGE_DISCONTINUITY(ELEM2,4)=EDGE_DISCONTINUITY(J,4)                 
!                                        
                    QSI(ELEM2,1,1)=QSI(J,1,1) 
                    QSI(ELEM2,1,2)=QSI(J,1,2) 
                    QSI(ELEM2,2,1)=0.6D0
                    QSI(ELEM2,2,2)=-0.6D0
                    QSI(ELEM2,3,1)=0.6D0 
                    QSI(ELEM2,3,2)=0.6D0
                    QSI(ELEM2,4,1)=QSI(J,4,1)  
                    QSI(ELEM2,4,2)=QSI(J,4,2)                  
                ENDIF
                IF(CRACKED_EDGES(J,1).EQ.3.AND.CRACKED_EDGES(J,2).EQ.4)THEN 
                    CONT1=CONT1+3
                    COORD_NODES(NODE1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(NODE2,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                      
                    COORD_NODES(N_NODES+CONT1-2,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)
                    COORD_NODES(NODE3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(NODE4,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                                              
                    COORD_NODES(N_NODES+CONT1-1,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)
                    COORD_NODES(N_NODES+CONT1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                
!                         
                    CONT2=CONT2+1        
                    ELEM_TYPE(N_ELEM+CONT2)=3          
                    ELEM_TYPE(ELEM1)=4
                    ELEM_TYPE(ELEM2)=4                    
!
                    ND(N_ELEM+CONT2)=ND(J)
                    ND(ELEM1)=ND(J)  
                    ND(ELEM2)=ND(J)
! 
                    NEW_ELEMENTS(J,1)=N_ELEM+CONT2
                    NEW_ELEMENTS(J,2)=ELEM1
                    NEW_ELEMENTS(J,3)=ELEM2                                                                
!
                    NODES_CONNECTIVITY(N_ELEM+CONT2,1)=NODE2   
                    NODES_CONNECTIVITY(N_ELEM+CONT2,2)=NODE1                             
                    NODES_CONNECTIVITY(N_ELEM+CONT2,3)=NODES_CONNECTIVITY(J,4)    
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=CP2   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=CP1                             
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=COLLOCPOINTS_CONNECTIVITY(J,4)
!                    
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=0  
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=0
                    IF(EDGE_DISCONTINUITY(J,4).EQ.3)THEN        
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=2
                    ELSE IF(EDGE_DISCONTINUITY(J,4).EQ.4)THEN
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=3
                    ELSE
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=0
                    ENDIF                              
!                                        
                    QSI(N_ELEM+CONT2,1,1)=0.8D0 
                    QSI(N_ELEM+CONT2,1,2)=0.1D0
                    QSI(N_ELEM+CONT2,2,1)=0.1D0
                    QSI(N_ELEM+CONT2,2,2)=0.8D0
                    QSI(N_ELEM+CONT2,3,1)=0.D0
                    QSI(N_ELEM+CONT2,3,2)=0.D0  
!                    
                    NODES_CONNECTIVITY(ELEM1,1)=NODE4    
                    NODES_CONNECTIVITY(ELEM1,2)=N_NODES+CONT1-2                                
                    NODES_CONNECTIVITY(ELEM1,3)=NODES_CONNECTIVITY(J,3)
                    NODES_CONNECTIVITY(ELEM1,4)=NODE3 
!
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,1)=CP4  
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,2)=N_COLLOCPOINTS+CONT1-2                               
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,3)=COLLOCPOINTS_CONNECTIVITY(J,3)     
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,4)=CP3 
!                    
                    EDGE_DISCONTINUITY(ELEM1,1)=0
                    EDGE_DISCONTINUITY(ELEM1,2)=0   
                    EDGE_DISCONTINUITY(ELEM1,3)=EDGE_DISCONTINUITY(J,3)
                    EDGE_DISCONTINUITY(ELEM1,4)=0                        
!                                        
                    QSI(ELEM1,1,1)=-0.6D0
                    QSI(ELEM1,1,2)=-0.6D0 
                    QSI(ELEM1,2,1)=0.6D0
                    QSI(ELEM1,2,2)=-0.6D0
                    QSI(ELEM1,3,1)=QSI(J,3,1)
                    QSI(ELEM1,3,2)=QSI(J,3,2)  
                    QSI(ELEM1,4,1)=-0.6D0
                    QSI(ELEM1,4,2)=0.6D0  
!                    
                    NODES_CONNECTIVITY(ELEM2,1)=NODES_CONNECTIVITY(J,1)  
                    NODES_CONNECTIVITY(ELEM2,2)=NODES_CONNECTIVITY(J,2)                           
                    NODES_CONNECTIVITY(ELEM2,3)=N_NODES+CONT1-1   
                    NODES_CONNECTIVITY(ELEM2,4)=N_NODES+CONT1   
!
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,1)=COLLOCPOINTS_CONNECTIVITY(J,1)  
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                              
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,3)=N_COLLOCPOINTS+CONT1-1  
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,4)=N_COLLOCPOINTS+CONT1
!                    
                    EDGE_DISCONTINUITY(ELEM2,1)=EDGE_DISCONTINUITY(J,1)
                    EDGE_DISCONTINUITY(ELEM2,2)=EDGE_DISCONTINUITY(J,2)   
                    EDGE_DISCONTINUITY(ELEM2,3)=0
                    EDGE_DISCONTINUITY(ELEM2,4)=0                        
!                                        
                    QSI(ELEM2,1,1)=QSI(J,1,1) 
                    QSI(ELEM2,1,2)=QSI(J,1,2) 
                    QSI(ELEM2,2,1)=QSI(J,2,1) 
                    QSI(ELEM2,2,2)=QSI(J,2,2)
                    QSI(ELEM2,3,1)=0.6D0 
                    QSI(ELEM2,3,2)=0.6D0
                    QSI(ELEM2,4,1)=-0.6D0  
                    QSI(ELEM2,4,2)=0.6D0                 
                ENDIF
                IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.4)THEN 
                    CONT1=CONT1+3
                    COORD_NODES(NODE1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(NODE2,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                      
                    COORD_NODES(N_NODES+CONT1-2,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)
                    COORD_NODES(NODE3,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                    COORD_NODES(NODE4,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                                              
                    COORD_NODES(N_NODES+CONT1-1,:)=COORD_EXTRAINTERCEPTPOINTS(J,:)
                    COORD_NODES(N_NODES+CONT1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,2),:)                
!                         
                    CONT2=CONT2+1        
                    ELEM_TYPE(N_ELEM+CONT2)=3          
                    ELEM_TYPE(ELEM1)=4
                    ELEM_TYPE(ELEM2)=4                    
!
                    ND(N_ELEM+CONT2)=ND(J)
                    ND(ELEM1)=ND(J)  
                    ND(ELEM2)=ND(J)
! 
                    NEW_ELEMENTS(J,1)=N_ELEM+CONT2
                    NEW_ELEMENTS(J,2)=ELEM1
                    NEW_ELEMENTS(J,3)=ELEM2                                                                
!
                    NODES_CONNECTIVITY(N_ELEM+CONT2,1)=NODE1   
                    NODES_CONNECTIVITY(N_ELEM+CONT2,2)=NODE2                             
                    NODES_CONNECTIVITY(N_ELEM+CONT2,3)=NODES_CONNECTIVITY(J,1)    
!
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,1)=CP1   
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,2)=CP2                             
                    COLLOCPOINTS_CONNECTIVITY(N_ELEM+CONT2,3)=COLLOCPOINTS_CONNECTIVITY(J,1)
!                    
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,1)=0 
                    EDGE_DISCONTINUITY(N_ELEM+CONT2,2)=0
                    IF(EDGE_DISCONTINUITY(J,1).EQ.1)THEN       
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=3  
                    ELSE IF(EDGE_DISCONTINUITY(J,1).EQ.4)THEN  
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=2
                    ELSE
                        EDGE_DISCONTINUITY(N_ELEM+CONT2,3)=0                    
                    ENDIF                                                    
!                                        
                    QSI(N_ELEM+CONT2,1,1)=0.8D0 
                    QSI(N_ELEM+CONT2,1,2)=0.1D0
                    QSI(N_ELEM+CONT2,2,1)=0.1D0
                    QSI(N_ELEM+CONT2,2,2)=0.8D0
                    QSI(N_ELEM+CONT2,3,1)=0.D0
                    QSI(N_ELEM+CONT2,3,2)=0.D0  
!                    
                    NODES_CONNECTIVITY(ELEM1,1)=NODE3    
                    NODES_CONNECTIVITY(ELEM1,2)=NODES_CONNECTIVITY(J,2)                                
                    NODES_CONNECTIVITY(ELEM1,3)=N_NODES+CONT1-2
                    NODES_CONNECTIVITY(ELEM1,4)=NODE4 
!
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,1)=CP3  
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,2)=COLLOCPOINTS_CONNECTIVITY(J,2)                              
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,3)=N_COLLOCPOINTS+CONT1-2      
                    COLLOCPOINTS_CONNECTIVITY(ELEM1,4)=CP4
!                    
                    EDGE_DISCONTINUITY(ELEM1,1)=0
                    EDGE_DISCONTINUITY(ELEM1,2)=EDGE_DISCONTINUITY(J,2)   
                    EDGE_DISCONTINUITY(ELEM1,3)=0
                    EDGE_DISCONTINUITY(ELEM1,4)=0                        
!                                        
                    QSI(ELEM1,1,1)=-0.6D0
                    QSI(ELEM1,1,2)=-0.6D0 
                    QSI(ELEM1,2,1)=QSI(J,2,1)
                    QSI(ELEM1,2,2)=QSI(J,2,2) 
                    QSI(ELEM1,3,1)=0.6D0
                    QSI(ELEM1,3,2)=0.6D0 
                    QSI(ELEM1,4,1)=-0.6D0
                    QSI(ELEM1,4,2)=0.6D0  
!                    
                    NODES_CONNECTIVITY(ELEM2,1)=N_NODES+CONT1  
                    NODES_CONNECTIVITY(ELEM2,2)=N_NODES+CONT1-1                           
                    NODES_CONNECTIVITY(ELEM2,3)=NODES_CONNECTIVITY(J,3)    
                    NODES_CONNECTIVITY(ELEM2,4)=NODES_CONNECTIVITY(J,4)    
!
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,1)=N_COLLOCPOINTS+CONT1
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,2)=N_COLLOCPOINTS+CONT1-1                              
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,3)=COLLOCPOINTS_CONNECTIVITY(J,3)
                    COLLOCPOINTS_CONNECTIVITY(ELEM2,4)=COLLOCPOINTS_CONNECTIVITY(J,4)
!                    
                    EDGE_DISCONTINUITY(ELEM2,1)=0
                    EDGE_DISCONTINUITY(ELEM2,2)=0
                    EDGE_DISCONTINUITY(ELEM2,3)=EDGE_DISCONTINUITY(J,3)
                    EDGE_DISCONTINUITY(ELEM2,4)=EDGE_DISCONTINUITY(J,4)                         
!                                        
                    QSI(ELEM2,1,1)=-0.6D0 
                    QSI(ELEM2,1,2)=-0.6D0  
                    QSI(ELEM2,2,1)=0.6D0 
                    QSI(ELEM2,2,2)=-0.6D0 
                    QSI(ELEM2,3,1)=QSI(J,3,1)  
                    QSI(ELEM2,3,2)=QSI(J,3,2)
                    QSI(ELEM2,4,1)=QSI(J,4,1)    
                    QSI(ELEM2,4,2)=QSI(J,4,2)               
                ENDIF                                                                
            ENDSELECT                  
        ELSE IF(PREVIOUS_CRACKED_ELEM(J).EQ."CRACKTIP".AND.CRACKED_ELEM(J).EQ."CRACKTIP")THEN
            ELEM1=NEW_ELEMENTS(J,1)
            ELEM2=NEW_ELEMENTS(J,2)
            ELEM3=NEW_ELEMENTS(J,3)  
!                    
            CHANGEABLE_ELEM(ELEM1)="CHANGED" 
            CHANGEABLE_ELEM(ELEM2)="CHANGED"   
            CHANGEABLE_ELEM(ELEM3)="CHANGED"                                                                      
            IF(CRACKED_EDGES(J,1).EQ.1)THEN
                NODE1=NODES_CONNECTIVITY(ELEM1,1)
                NODE2=NODES_CONNECTIVITY(ELEM1,4)
                NODE3=NODES_CONNECTIVITY(ELEM1,3)   
                NODE4=NODES_CONNECTIVITY(ELEM2,4)       
                NODE5=NODES_CONNECTIVITY(ELEM2,2)  
                NODE6=NODES_CONNECTIVITY(ELEM2,3)   
                NODE7=NODES_CONNECTIVITY(ELEM3,2)   
                NODE8=NODES_CONNECTIVITY(ELEM3,1)
!                        
                COORD_NODES(NODE1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                COORD_NODES(NODE2,:)=COORD_BOUNDARYCRACKTIP(J,:)      
                COORD_NODES(NODE3,:)=COORD_BOUNDARYCRACKTIPSTOP(J,1,:)
                COORD_NODES(NODE4,:)=COORD_BOUNDARYCRACKTIPSTOP(J,2,:)    
                COORD_NODES(NODE5,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                COORD_NODES(NODE6,:)=COORD_BOUNDARYCRACKTIP(J,:)      
                COORD_NODES(NODE7,:)=COORD_BOUNDARYCRACKTIPSTOP(J,1,:)
                COORD_NODES(NODE8,:)=COORD_BOUNDARYCRACKTIPSTOP(J,2,:)
!
                X1=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),1)       
                X2=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),2)  
                X3=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),3)   
       
                X1=COORD_BOUNDARYCRACKTIP(J,1)       
                X2=COORD_BOUNDARYCRACKTIP(J,2)  
                X3=COORD_BOUNDARYCRACKTIP(J,3)
                
                X1=COORD_BOUNDARYCRACKTIPSTOP(J,1,1)      
                X2=COORD_BOUNDARYCRACKTIPSTOP(J,1,2)
                X3=COORD_BOUNDARYCRACKTIPSTOP(J,1,3)   
                
                X1=COORD_BOUNDARYCRACKTIPSTOP(J,2,1)      
                X2=COORD_BOUNDARYCRACKTIPSTOP(J,2,2)
                X3=COORD_BOUNDARYCRACKTIPSTOP(J,2,3)                                                                                                                     
!
                CP1=COLLOCPOINTS_CONNECTIVITY(ELEM1,1)
                CP2=COLLOCPOINTS_CONNECTIVITY(ELEM1,4)
                CP3=COLLOCPOINTS_CONNECTIVITY(ELEM1,3)   
                CP4=COLLOCPOINTS_CONNECTIVITY(ELEM2,4)       
                CP5=COLLOCPOINTS_CONNECTIVITY(ELEM2,2)  
                CP6=COLLOCPOINTS_CONNECTIVITY(ELEM2,3)   
                CP7=COLLOCPOINTS_CONNECTIVITY(ELEM3,2)   
                CP8=COLLOCPOINTS_CONNECTIVITY(ELEM3,1)
!
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGED"  
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP5)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP6)="CHANGED"  
                CHANGEABLE_COLLOCPOINTS(CP7)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP8)="CHANGED"                               
!            
            ENDIF                                                                                  
            IF(CRACKED_EDGES(J,1).EQ.2)THEN  
                NODE1=NODES_CONNECTIVITY(ELEM1,2)
                NODE2=NODES_CONNECTIVITY(ELEM1,1)
                NODE3=NODES_CONNECTIVITY(ELEM1,4)   
                NODE4=NODES_CONNECTIVITY(ELEM2,1)       
                NODE5=NODES_CONNECTIVITY(ELEM2,3)  
                NODE6=NODES_CONNECTIVITY(ELEM2,4)   
                NODE7=NODES_CONNECTIVITY(ELEM3,3)   
                NODE8=NODES_CONNECTIVITY(ELEM3,2)
!                        
                COORD_NODES(NODE1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                COORD_NODES(NODE2,:)=COORD_BOUNDARYCRACKTIP(J,:)      
                COORD_NODES(NODE3,:)=COORD_BOUNDARYCRACKTIPSTOP(J,1,:)
                COORD_NODES(NODE4,:)=COORD_BOUNDARYCRACKTIPSTOP(J,2,:)    
                COORD_NODES(NODE5,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                COORD_NODES(NODE6,:)=COORD_BOUNDARYCRACKTIP(J,:)      
                COORD_NODES(NODE7,:)=COORD_BOUNDARYCRACKTIPSTOP(J,1,:)
                COORD_NODES(NODE8,:)=COORD_BOUNDARYCRACKTIPSTOP(J,2,:) 
!
                X1=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),1)       
                X2=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),2)  
                X3=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),3)   
       
                X1=COORD_BOUNDARYCRACKTIP(J,1)       
                X2=COORD_BOUNDARYCRACKTIP(J,2)  
                X3=COORD_BOUNDARYCRACKTIP(J,3)
                
                X1=COORD_BOUNDARYCRACKTIPSTOP(J,1,1)      
                X2=COORD_BOUNDARYCRACKTIPSTOP(J,1,2)
                X3=COORD_BOUNDARYCRACKTIPSTOP(J,1,3)   
                
                X1=COORD_BOUNDARYCRACKTIPSTOP(J,2,1)      
                X2=COORD_BOUNDARYCRACKTIPSTOP(J,2,2)
                X3=COORD_BOUNDARYCRACKTIPSTOP(J,2,3)                               
!
                CP1=COLLOCPOINTS_CONNECTIVITY(ELEM1,2)
                CP2=COLLOCPOINTS_CONNECTIVITY(ELEM1,1)
                CP3=COLLOCPOINTS_CONNECTIVITY(ELEM1,4)   
                CP4=COLLOCPOINTS_CONNECTIVITY(ELEM2,1)       
                CP5=COLLOCPOINTS_CONNECTIVITY(ELEM2,3)  
                CP6=COLLOCPOINTS_CONNECTIVITY(ELEM2,4)   
                CP7=COLLOCPOINTS_CONNECTIVITY(ELEM3,3)   
                CP8=COLLOCPOINTS_CONNECTIVITY(ELEM3,2)
!
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGED"  
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP5)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP6)="CHANGED"  
                CHANGEABLE_COLLOCPOINTS(CP7)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP8)="CHANGED"                
!            
            ENDIF                                          
            IF(CRACKED_EDGES(J,1).EQ.3)THEN
                NODE1=NODES_CONNECTIVITY(ELEM1,3)
                NODE2=NODES_CONNECTIVITY(ELEM1,2)
                NODE3=NODES_CONNECTIVITY(ELEM1,1)   
                NODE4=NODES_CONNECTIVITY(ELEM2,2)       
                NODE5=NODES_CONNECTIVITY(ELEM2,4)  
                NODE6=NODES_CONNECTIVITY(ELEM2,1)   
                NODE7=NODES_CONNECTIVITY(ELEM3,4)   
                NODE8=NODES_CONNECTIVITY(ELEM3,3)
!                        
                COORD_NODES(NODE1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                COORD_NODES(NODE2,:)=COORD_BOUNDARYCRACKTIP(J,:)      
                COORD_NODES(NODE3,:)=COORD_BOUNDARYCRACKTIPSTOP(J,1,:)
                COORD_NODES(NODE4,:)=COORD_BOUNDARYCRACKTIPSTOP(J,2,:)    
                COORD_NODES(NODE5,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                COORD_NODES(NODE6,:)=COORD_BOUNDARYCRACKTIP(J,:)      
                COORD_NODES(NODE7,:)=COORD_BOUNDARYCRACKTIPSTOP(J,1,:)
                COORD_NODES(NODE8,:)=COORD_BOUNDARYCRACKTIPSTOP(J,2,:)
!
                X1=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),1)       
                X2=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),2)  
                X3=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),3)   
       
                X1=COORD_BOUNDARYCRACKTIP(J,1)       
                X2=COORD_BOUNDARYCRACKTIP(J,2)  
                X3=COORD_BOUNDARYCRACKTIP(J,3)
                
                X1=COORD_BOUNDARYCRACKTIPSTOP(J,1,1)      
                X2=COORD_BOUNDARYCRACKTIPSTOP(J,1,2)
                X3=COORD_BOUNDARYCRACKTIPSTOP(J,1,3)   
                
                X1=COORD_BOUNDARYCRACKTIPSTOP(J,2,1)      
                X2=COORD_BOUNDARYCRACKTIPSTOP(J,2,2)
                X3=COORD_BOUNDARYCRACKTIPSTOP(J,2,3)                                
!
                CP1=COLLOCPOINTS_CONNECTIVITY(ELEM1,3)
                CP2=COLLOCPOINTS_CONNECTIVITY(ELEM1,2)
                CP3=COLLOCPOINTS_CONNECTIVITY(ELEM1,1)   
                CP4=COLLOCPOINTS_CONNECTIVITY(ELEM2,2)       
                CP5=COLLOCPOINTS_CONNECTIVITY(ELEM2,4)  
                CP6=COLLOCPOINTS_CONNECTIVITY(ELEM2,1)   
                CP7=COLLOCPOINTS_CONNECTIVITY(ELEM3,4)   
                CP8=COLLOCPOINTS_CONNECTIVITY(ELEM3,3)
!
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGED"  
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP5)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP6)="CHANGED"  
                CHANGEABLE_COLLOCPOINTS(CP7)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP8)="CHANGED"                
!            
            ENDIF                                                                                                   
            IF(CRACKED_EDGES(J,1).EQ.4)THEN
                NODE1=NODES_CONNECTIVITY(ELEM1,4)
                NODE2=NODES_CONNECTIVITY(ELEM1,3)
                NODE3=NODES_CONNECTIVITY(ELEM1,2)   
                NODE4=NODES_CONNECTIVITY(ELEM2,3)       
                NODE5=NODES_CONNECTIVITY(ELEM2,1)  
                NODE6=NODES_CONNECTIVITY(ELEM2,2)   
                NODE7=NODES_CONNECTIVITY(ELEM3,1)   
                NODE8=NODES_CONNECTIVITY(ELEM3,4)
!                        
                COORD_NODES(NODE1,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                COORD_NODES(NODE2,:)=COORD_BOUNDARYCRACKTIP(J,:)      
                COORD_NODES(NODE3,:)=COORD_BOUNDARYCRACKTIPSTOP(J,1,:)
                COORD_NODES(NODE4,:)=COORD_BOUNDARYCRACKTIPSTOP(J,2,:)    
                COORD_NODES(NODE5,:)=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),:)
                COORD_NODES(NODE6,:)=COORD_BOUNDARYCRACKTIP(J,:)      
                COORD_NODES(NODE7,:)=COORD_BOUNDARYCRACKTIPSTOP(J,1,:)
                COORD_NODES(NODE8,:)=COORD_BOUNDARYCRACKTIPSTOP(J,2,:) 
!
                X1=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),1)       
                X2=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),2)  
                X3=COORD_INTERCEPTPOINTS(J,CRACKED_EDGES(J,1),3)   
       
                X1=COORD_BOUNDARYCRACKTIP(J,1)       
                X2=COORD_BOUNDARYCRACKTIP(J,2)  
                X3=COORD_BOUNDARYCRACKTIP(J,3)
                
                X1=COORD_BOUNDARYCRACKTIPSTOP(J,1,1)      
                X2=COORD_BOUNDARYCRACKTIPSTOP(J,1,2)
                X3=COORD_BOUNDARYCRACKTIPSTOP(J,1,3)   
                
                X1=COORD_BOUNDARYCRACKTIPSTOP(J,2,1)      
                X2=COORD_BOUNDARYCRACKTIPSTOP(J,2,2)
                X3=COORD_BOUNDARYCRACKTIPSTOP(J,2,3)                               
!
                CP1=COLLOCPOINTS_CONNECTIVITY(ELEM1,4)
                CP2=COLLOCPOINTS_CONNECTIVITY(ELEM1,3)
                CP3=COLLOCPOINTS_CONNECTIVITY(ELEM1,2)   
                CP4=COLLOCPOINTS_CONNECTIVITY(ELEM2,3)       
                CP5=COLLOCPOINTS_CONNECTIVITY(ELEM2,1)  
                CP6=COLLOCPOINTS_CONNECTIVITY(ELEM2,2)   
                CP7=COLLOCPOINTS_CONNECTIVITY(ELEM3,1)   
                CP8=COLLOCPOINTS_CONNECTIVITY(ELEM3,4)
!
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGED"  
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP5)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP6)="CHANGED"  
                CHANGEABLE_COLLOCPOINTS(CP7)="CHANGED"   
                CHANGEABLE_COLLOCPOINTS(CP8)="CHANGED"                
!                                                                           
            ENDIF                                                                       
        ENDIF
    ENDDO  
!
!------------------------------------------------------------------------------------------------------------------------------------------------------
!   CALCULATING THE CHANGED COLLOCATION POINTS  
!------------------------------------------------------------------------------------------------------------------------------------------------------
!       
    DO I=1,N_COLLOCPOINTS
        IF(CHANGEABLE_COLLOCPOINTS(I).EQ."CHANGED")THEN
            DO J=1,N_ELEM+N_ADDELEM
                NEN=ELEM_TYPE(J)*ORDER_ELEM(J)+(ELEM_TYPE(J)-3)*(ORDER_ELEM(J)-1)*POL_FAMILY(J)
                ALLOCATE(VALUES(NEN,3))
                DO K=1,NEN
                    VALUES(K,1)=COORD_NODES(NODES_CONNECTIVITY(J,K),1)
	                VALUES(K,2)=COORD_NODES(NODES_CONNECTIVITY(J,K),2)
	                VALUES(K,3)=COORD_NODES(NODES_CONNECTIVITY(J,K),3)
	            ENDDO               
    !                        
                DO K=1,NEN
                    IF(COLLOCPOINTS_CONNECTIVITY(J,K).EQ.I)THEN
                        CALL SHAPE_FUNCTIONS(1,QSI(J,K,1),QSI(J,K,2),NEN,VALUES,COEFFICIENTS,X1,X2,X3,PHI,DPHI,D2PHI)
                        COORD_COLLOCPOINTS(I,1)=X1
                        COORD_COLLOCPOINTS(I,2)=X2
                        COORD_COLLOCPOINTS(I,3)=X3
                    ENDIF
                ENDDO         
                DEALLOCATE(VALUES)
            ENDDO
        ENDIF
    ENDDO        
!
!------------------------------------------------------------------------------------------------------------------------------------------------------
!   DEFINING THE ADDITIONAL COLLOCATION POINTS  
!------------------------------------------------------------------------------------------------------------------------------------------------------
!       
    DO I=N_COLLOCPOINTS+1,N_COLLOCPOINTS+N_ADDCOLLOCPOINTS
        DO J=1,N_ELEM+N_ADDELEM
            NEN=ELEM_TYPE(J)*ORDER_ELEM(J)+(ELEM_TYPE(J)-3)*(ORDER_ELEM(J)-1)*POL_FAMILY(J)
            ALLOCATE(VALUES(NEN,3))
            DO K=1,NEN
                VALUES(K,1)=COORD_NODES(NODES_CONNECTIVITY(J,K),1)
	            VALUES(K,2)=COORD_NODES(NODES_CONNECTIVITY(J,K),2)
	            VALUES(K,3)=COORD_NODES(NODES_CONNECTIVITY(J,K),3)
	        ENDDO               
!                        
            DO K=1,NEN
                IF(COLLOCPOINTS_CONNECTIVITY(J,K).EQ.I)THEN
                    CALL SHAPE_FUNCTIONS(1,QSI(J,K,1),QSI(J,K,2),NEN,VALUES,COEFFICIENTS,X1,X2,X3,PHI,DPHI,D2PHI)
                    COORD_COLLOCPOINTS(I,1)=X1
                    COORD_COLLOCPOINTS(I,2)=X2
                    COORD_COLLOCPOINTS(I,3)=X3
                ENDIF
            ENDDO         
            DEALLOCATE(VALUES)
        ENDDO
    ENDDO    
!------------------------------------------------------------------------------------------------------------------------------------------------------
!               ALLOCATING THE ADDITIONAL "L" AT THE MATRIX H AND G
!------------------------------------------------------------------------------------------------------------------------------------------------------ 
    ALLOCATE(HG_AUX(3*N_COLLOCPOINTS,3*N_COLLOCPOINTS),UT_AUX(3*N_COLLOCPOINTS))
    HG_AUX=H
    UT_AUX=U
    DEALLOCATE(H,U)
    ALLOCATE(H(3*(N_COLLOCPOINTS+N_ADDCOLLOCPOINTS),3*(N_COLLOCPOINTS+N_ADDCOLLOCPOINTS)),U(3*(N_COLLOCPOINTS+N_ADDCOLLOCPOINTS))) 
    H=0.D0
    U=0.D0
    DO I=1,3*N_COLLOCPOINTS
        U(I)=UT_AUX(I)
        DO J=1,3*N_COLLOCPOINTS
            H(I,J)=HG_AUX(I,J)
        ENDDO
    ENDDO
    HG_AUX=G
    UT_AUX=T
    DEALLOCATE(G,T)
    ALLOCATE(G(3*(N_COLLOCPOINTS+N_ADDCOLLOCPOINTS),3*(N_COLLOCPOINTS+N_ADDCOLLOCPOINTS)),T(3*(N_COLLOCPOINTS+N_ADDCOLLOCPOINTS))) 
    G=0.D0
    T=0.D0
    DO I=1,3*N_COLLOCPOINTS
        T(I)=UT_AUX(I)
        DO J=1,3*N_COLLOCPOINTS
            G(I,J)=HG_AUX(I,J)
        ENDDO
    ENDDO
!    
    N_NODES=N_NODES+N_ADDNODES
    N_COLLOCPOINTS=N_COLLOCPOINTS+N_ADDCOLLOCPOINTS
	N_ELEM=N_ELEM+N_ADDELEM	
!    
    CALL EDGE_CRACKS_HG_UPDATE(PREVIOUS_CRACKED_ELEM)        
!
    DO J=1,N_ELEM-N_ADDELEM	
        IF(PREVIOUS_CRACKED_ELEM(J).EQ."UNCRACKED".AND.CRACKED_ELEM(J).EQ."CRACKTIP")THEN
            ELEM1=NEW_ELEMENTS(J,1)
            ELEM2=NEW_ELEMENTS(J,2)
            ELEM3=NEW_ELEMENTS(J,3)
            
            CHANGEABLE_ELEM(ELEM1)="CHANGEABLE"
            CHANGEABLE_ELEM(ELEM2)="CHANGEABLE"  
            CHANGEABLE_ELEM(ELEM3)="CHANGEABLE"          
!
            IF(CRACKED_EDGES(J,1).EQ.1)THEN               
                CP1=COLLOCPOINTS_CONNECTIVITY(ELEM1,1)
                CP2=COLLOCPOINTS_CONNECTIVITY(ELEM1,4)
                CP3=COLLOCPOINTS_CONNECTIVITY(ELEM1,3)   
                CP4=COLLOCPOINTS_CONNECTIVITY(ELEM2,4)       
                CP5=COLLOCPOINTS_CONNECTIVITY(ELEM2,2)  
                CP6=COLLOCPOINTS_CONNECTIVITY(ELEM2,3)   
                CP7=COLLOCPOINTS_CONNECTIVITY(ELEM3,2)   
                CP8=COLLOCPOINTS_CONNECTIVITY(ELEM3,1)
!
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(CP5)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP6)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP7)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP8)="CHANGEABLE"                                       
            ENDIF                                                                                  
            IF(CRACKED_EDGES(J,1).EQ.2)THEN                
                CP1=COLLOCPOINTS_CONNECTIVITY(ELEM1,2)
                CP2=COLLOCPOINTS_CONNECTIVITY(ELEM1,1)
                CP3=COLLOCPOINTS_CONNECTIVITY(ELEM1,4)   
                CP4=COLLOCPOINTS_CONNECTIVITY(ELEM2,1)       
                CP5=COLLOCPOINTS_CONNECTIVITY(ELEM2,3)  
                CP6=COLLOCPOINTS_CONNECTIVITY(ELEM2,4)   
                CP7=COLLOCPOINTS_CONNECTIVITY(ELEM3,3)   
                CP8=COLLOCPOINTS_CONNECTIVITY(ELEM3,2)
!
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(CP5)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP6)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP7)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP8)="CHANGEABLE"                        
            ENDIF                                          
            IF(CRACKED_EDGES(J,1).EQ.3)THEN             
                CP1=COLLOCPOINTS_CONNECTIVITY(ELEM1,3)
                CP2=COLLOCPOINTS_CONNECTIVITY(ELEM1,2)
                CP3=COLLOCPOINTS_CONNECTIVITY(ELEM1,1)   
                CP4=COLLOCPOINTS_CONNECTIVITY(ELEM2,2)       
                CP5=COLLOCPOINTS_CONNECTIVITY(ELEM2,4)  
                CP6=COLLOCPOINTS_CONNECTIVITY(ELEM2,1)   
                CP7=COLLOCPOINTS_CONNECTIVITY(ELEM3,4)   
                CP8=COLLOCPOINTS_CONNECTIVITY(ELEM3,3)
!
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(CP5)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP6)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP7)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP8)="CHANGEABLE"                           
            ENDIF                                                                                                   
            IF(CRACKED_EDGES(J,1).EQ.4)THEN               
                CP1=COLLOCPOINTS_CONNECTIVITY(ELEM1,4)
                CP2=COLLOCPOINTS_CONNECTIVITY(ELEM1,3)
                CP3=COLLOCPOINTS_CONNECTIVITY(ELEM1,2)   
                CP4=COLLOCPOINTS_CONNECTIVITY(ELEM2,3)       
                CP5=COLLOCPOINTS_CONNECTIVITY(ELEM2,1)  
                CP6=COLLOCPOINTS_CONNECTIVITY(ELEM2,2)   
                CP7=COLLOCPOINTS_CONNECTIVITY(ELEM3,1)   
                CP8=COLLOCPOINTS_CONNECTIVITY(ELEM3,4)
!
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(CP5)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP6)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP7)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP8)="CHANGEABLE"                                                                                
            ENDIF   
!                                                    
        ENDIF
        IF(PREVIOUS_CRACKED_ELEM(J).EQ."CRACKTIP".AND.CRACKED_ELEM(J).EQ."CRACKTIP")THEN
            ELEM1=NEW_ELEMENTS(J,1)
            ELEM2=NEW_ELEMENTS(J,2)
            ELEM3=NEW_ELEMENTS(J,3)
            
            CHANGEABLE_ELEM(ELEM1)="CHANGEABLE"
            CHANGEABLE_ELEM(ELEM2)="CHANGEABLE"  
            CHANGEABLE_ELEM(ELEM3)="CHANGEABLE"          
!
            IF(CRACKED_EDGES(J,1).EQ.1)THEN               
                CP1=COLLOCPOINTS_CONNECTIVITY(ELEM1,1)
                CP2=COLLOCPOINTS_CONNECTIVITY(ELEM1,4)
                CP3=COLLOCPOINTS_CONNECTIVITY(ELEM1,3)   
                CP4=COLLOCPOINTS_CONNECTIVITY(ELEM2,4)       
                CP5=COLLOCPOINTS_CONNECTIVITY(ELEM2,2)  
                CP6=COLLOCPOINTS_CONNECTIVITY(ELEM2,3)   
                CP7=COLLOCPOINTS_CONNECTIVITY(ELEM3,2)   
                CP8=COLLOCPOINTS_CONNECTIVITY(ELEM3,1)
!
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(CP5)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP6)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP7)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP8)="CHANGEABLE"                                       
            ENDIF                                                                                  
            IF(CRACKED_EDGES(J,1).EQ.2)THEN                
                CP1=COLLOCPOINTS_CONNECTIVITY(ELEM1,2)
                CP2=COLLOCPOINTS_CONNECTIVITY(ELEM1,1)
                CP3=COLLOCPOINTS_CONNECTIVITY(ELEM1,4)   
                CP4=COLLOCPOINTS_CONNECTIVITY(ELEM2,1)       
                CP5=COLLOCPOINTS_CONNECTIVITY(ELEM2,3)  
                CP6=COLLOCPOINTS_CONNECTIVITY(ELEM2,4)   
                CP7=COLLOCPOINTS_CONNECTIVITY(ELEM3,3)   
                CP8=COLLOCPOINTS_CONNECTIVITY(ELEM3,2)
!
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(CP5)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP6)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP7)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP8)="CHANGEABLE"                        
            ENDIF                                          
            IF(CRACKED_EDGES(J,1).EQ.3)THEN             
                CP1=COLLOCPOINTS_CONNECTIVITY(ELEM1,3)
                CP2=COLLOCPOINTS_CONNECTIVITY(ELEM1,2)
                CP3=COLLOCPOINTS_CONNECTIVITY(ELEM1,1)   
                CP4=COLLOCPOINTS_CONNECTIVITY(ELEM2,2)       
                CP5=COLLOCPOINTS_CONNECTIVITY(ELEM2,4)  
                CP6=COLLOCPOINTS_CONNECTIVITY(ELEM2,1)   
                CP7=COLLOCPOINTS_CONNECTIVITY(ELEM3,4)   
                CP8=COLLOCPOINTS_CONNECTIVITY(ELEM3,3)
!
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(CP5)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP6)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP7)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP8)="CHANGEABLE"                           
            ENDIF                                                                                                   
            IF(CRACKED_EDGES(J,1).EQ.4)THEN               
                CP1=COLLOCPOINTS_CONNECTIVITY(ELEM1,4)
                CP2=COLLOCPOINTS_CONNECTIVITY(ELEM1,3)
                CP3=COLLOCPOINTS_CONNECTIVITY(ELEM1,2)   
                CP4=COLLOCPOINTS_CONNECTIVITY(ELEM2,3)       
                CP5=COLLOCPOINTS_CONNECTIVITY(ELEM2,1)  
                CP6=COLLOCPOINTS_CONNECTIVITY(ELEM2,2)   
                CP7=COLLOCPOINTS_CONNECTIVITY(ELEM3,1)   
                CP8=COLLOCPOINTS_CONNECTIVITY(ELEM3,4)
!
                CHANGEABLE_COLLOCPOINTS(CP1)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP2)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP3)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP4)="CHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(CP5)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP6)="CHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(CP7)="CHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(CP8)="CHANGEABLE"                                                                                
            ENDIF     
!                                                                                                  
        ENDIF   
        IF(PREVIOUS_CRACKED_ELEM(J).EQ."CRACKTIP".AND.CRACKED_ELEM(J).EQ."CRACKED")THEN
            IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.3)THEN 
                ELEM1=NEW_ELEMENTS(J,1)
                ELEM2=NEW_ELEMENTS(J,2)
                
                CHANGEABLE_ELEM(ELEM1)="UNCHANGEABLE"
                CHANGEABLE_ELEM(ELEM2)="UNCHANGEABLE"           

                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,3))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,4))="UNCHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,3))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,4))="UNCHANGEABLE"  
            ENDIF 
            IF(CRACKED_EDGES(J,1).EQ.2.AND.CRACKED_EDGES(J,2).EQ.4)THEN 
                ELEM1=NEW_ELEMENTS(J,1)
                ELEM2=NEW_ELEMENTS(J,2)
                
                CHANGEABLE_ELEM(ELEM1)="UNCHANGEABLE"
                CHANGEABLE_ELEM(ELEM2)="UNCHANGEABLE"           

                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,3))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,4))="UNCHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,3))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,4))="UNCHANGEABLE"  
            ENDIF
            IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.2)THEN
                ELEM1=NEW_ELEMENTS(J,1)
                ELEM2=NEW_ELEMENTS(J,2)
                ELEM3=NEW_ELEMENTS(J,3)                
                
                CHANGEABLE_ELEM(ELEM1)="UNCHANGEABLE"
                CHANGEABLE_ELEM(ELEM2)="UNCHANGEABLE"  
                CHANGEABLE_ELEM(ELEM3)="UNCHANGEABLE"

                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,3))="UNCHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,3))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,4))="UNCHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,3))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,4))="UNCHANGEABLE"                                                            
            ENDIF 
            IF(CRACKED_EDGES(J,1).EQ.2.AND.CRACKED_EDGES(J,2).EQ.3)THEN
                ELEM1=NEW_ELEMENTS(J,1)
                ELEM2=NEW_ELEMENTS(J,2)
                ELEM3=NEW_ELEMENTS(J,3)                
                
                CHANGEABLE_ELEM(ELEM1)="UNCHANGEABLE"
                CHANGEABLE_ELEM(ELEM2)="UNCHANGEABLE"  
                CHANGEABLE_ELEM(ELEM3)="UNCHANGEABLE"

                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,3))="UNCHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,3))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,4))="UNCHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,3))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,4))="UNCHANGEABLE"                                                            
            ENDIF 
            IF(CRACKED_EDGES(J,1).EQ.3.AND.CRACKED_EDGES(J,2).EQ.4)THEN
                ELEM1=NEW_ELEMENTS(J,1)
                ELEM2=NEW_ELEMENTS(J,2)
                ELEM3=NEW_ELEMENTS(J,3)                
                
                CHANGEABLE_ELEM(ELEM1)="UNCHANGEABLE"
                CHANGEABLE_ELEM(ELEM2)="UNCHANGEABLE"  
                CHANGEABLE_ELEM(ELEM3)="UNCHANGEABLE"

                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,3))="UNCHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,3))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,4))="UNCHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,3))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,4))="UNCHANGEABLE"                                                            
            ENDIF
            IF(CRACKED_EDGES(J,1).EQ.1.AND.CRACKED_EDGES(J,2).EQ.4)THEN
                ELEM1=NEW_ELEMENTS(J,1)
                ELEM2=NEW_ELEMENTS(J,2)
                ELEM3=NEW_ELEMENTS(J,3)                
                
                CHANGEABLE_ELEM(ELEM1)="UNCHANGEABLE"
                CHANGEABLE_ELEM(ELEM2)="UNCHANGEABLE"  
                CHANGEABLE_ELEM(ELEM3)="UNCHANGEABLE"

                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM1,3))="UNCHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,3))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM2,4))="UNCHANGEABLE"  
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,1))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,2))="UNCHANGEABLE" 
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,3))="UNCHANGEABLE"
                CHANGEABLE_COLLOCPOINTS(COLLOCPOINTS_CONNECTIVITY(ELEM3,4))="UNCHANGEABLE"                                                            
            ENDIF                                                                                                                      
        ENDIF              
    ENDDO        
!              	    
    END SUBROUTINE EDGE_CRACKS_REMESHING