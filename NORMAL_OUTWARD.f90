    SUBROUTINE NORMAL_OUTWARD(NEN,VALUES,A1,A2,ETA,VJAC,DVJAC,JAC)
!
!	IN THIS SUBROUTINE, THE USER MUST INFORM THE NUMBER OF ELEMENT NODES (NEN), THE COORDINATES OF THE NODES (VALUES) AND 
!	THE DIMENSIONLESS COORDINATES A1 AND A2. THE NORMAL OUTWARD AND THE JACOBIAN ARE STORED IN ARE STORED IN ETA AND JAC VARIABLES
!    
    USE ISOPARAMETRIC_MESH
!
    IMPLICIT NONE
!    
    INTEGER::I,NEN   
!   
    REAL*8::A1,A2,X,Y,Z,VJAC(3),DVJAC(3,2),JAC,QSI1,QSI2,DXDQSI(2),DYDQSI(2),DZDQSI(2),ETA(3),VALUES(NEN,3),COEFFICIENTS(NEN,NEN),&
    PHI(NEN),DPHI(NEN,2),D2PHI(NEN,2,2)
     REAL*8::D2XD2QSI(2,2),D2YD2QSI(2,2),D2ZD2QSI(2,2)
!	
    DXDQSI=0.D0
    DYDQSI=0.D0
    DZDQSI=0.D0
    D2XD2QSI=0.D0
    D2YD2QSI=0.D0
    D2ZD2QSI=0.D0
    
    CALL SHAPE_FUNCTIONS(3,A1,A2,NEN,VALUES,COEFFICIENTS,X,Y,Z,PHI,DPHI,D2PHI)
        
    DO I=1,NEN    
        DXDQSI(1)=DXDQSI(1)+DPHI(I,1)*VALUES(I,1)
        DXDQSI(2)=DXDQSI(2)+DPHI(I,2)*VALUES(I,1)
! 
        DYDQSI(1)=DYDQSI(1)+DPHI(I,1)*VALUES(I,2)
        DYDQSI(2)=DYDQSI(2)+DPHI(I,2)*VALUES(I,2)
!
        DZDQSI(1)=DZDQSI(1)+DPHI(I,1)*VALUES(I,3)
        DZDQSI(2)=DZDQSI(2)+DPHI(I,2)*VALUES(I,3)           
    END DO
 !
    CALL SHAPE_FUNCTIONS(5,A1,A2,NEN,VALUES,COEFFICIENTS,X,Y,Z,PHI,DPHI,D2PHI)
 !   
    DO I=1,NEN
        D2XD2QSI(1,1)=D2XD2QSI(1,1)+D2PHI(I,1,1)*VALUES(I,1)
		D2XD2QSI(1,2)=D2XD2QSI(1,2)+D2PHI(I,1,2)*VALUES(I,1)
		D2XD2QSI(2,1)=D2XD2QSI(2,1)+D2PHI(I,2,1)*VALUES(I,1)
		D2XD2QSI(2,2)=D2XD2QSI(2,2)+D2PHI(I,2,2)*VALUES(I,1)
!		            
		D2YD2QSI(1,1)=D2YD2QSI(1,1)+D2PHI(I,1,1)*VALUES(I,2)
		D2YD2QSI(1,2)=D2YD2QSI(1,2)+D2PHI(I,1,2)*VALUES(I,2)
		D2YD2QSI(2,1)=D2YD2QSI(2,1)+D2PHI(I,2,1)*VALUES(I,2)
		D2YD2QSI(2,2)=D2YD2QSI(2,2)+D2PHI(I,2,2)*VALUES(I,2)
!		            
		D2ZD2QSI(1,1)=D2ZD2QSI(1,1)+D2PHI(I,1,1)*VALUES(I,3)
		D2ZD2QSI(1,2)=D2ZD2QSI(1,2)+D2PHI(I,1,2)*VALUES(I,3)
		D2ZD2QSI(2,1)=D2ZD2QSI(2,1)+D2PHI(I,2,1)*VALUES(I,3)
		D2ZD2QSI(2,2)=D2ZD2QSI(2,2)+D2PHI(I,2,2)*VALUES(I,3)
!		
	ENDDO   
!   
    VJAC(1)=DYDQSI(1)*DZDQSI(2)-DYDQSI(2)*DZDQSI(1)
    VJAC(2)=DZDQSI(1)*DXDQSI(2)-DZDQSI(2)*DXDQSI(1)
    VJAC(3)=DXDQSI(1)*DYDQSI(2)-DXDQSI(2)*DYDQSI(1)
    
    JAC=DSQRT(VJAC(1)**2+VJAC(2)**2+VJAC(3)**2)
    ETA=VJAC/JAC
    
    DVJAC(1,1)=D2YD2QSI(1,1)*DZDQSI(2)+DYDQSI(1)*D2ZD2QSI(2,1)-(D2YD2QSI(2,1)*DZDQSI(1)+DYDQSI(2)*D2ZD2QSI(1,1))
    DVJAC(1,2)=D2YD2QSI(1,2)*DZDQSI(2)+DYDQSI(1)*D2ZD2QSI(2,2)-(D2YD2QSI(2,2)*DZDQSI(1)+DYDQSI(2)*D2ZD2QSI(1,2))
    
    DVJAC(2,1)=D2ZD2QSI(1,1)*DXDQSI(2)+DZDQSI(1)*D2XD2QSI(2,1)-(D2ZD2QSI(2,1)*DXDQSI(1)+DZDQSI(2)*D2XD2QSI(1,1))
    DVJAC(2,2)=D2ZD2QSI(1,2)*DXDQSI(2)+DZDQSI(1)*D2XD2QSI(2,2)-(D2ZD2QSI(2,2)*DXDQSI(1)+DZDQSI(2)*D2XD2QSI(1,2))
    
    DVJAC(3,1)=D2XD2QSI(1,1)*DYDQSI(2)+DXDQSI(1)*D2YD2QSI(2,1)-(D2XD2QSI(2,1)*DYDQSI(1)+DXDQSI(2)*D2YD2QSI(1,1))
    DVJAC(3,2)=D2XD2QSI(1,2)*DYDQSI(2)+DXDQSI(1)*D2YD2QSI(2,2)-(D2XD2QSI(2,2)*DYDQSI(1)+DXDQSI(2)*D2YD2QSI(1,2))
!    
    END SUBROUTINE NORMAL_OUTWARD     